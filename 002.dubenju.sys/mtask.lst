     1 00000000                                 [FORMAT "WCOFF"]
     2 00000000                                 [INSTRSET "i486p"]
     3 00000000                                 [OPTIMIZE 1]
     4 00000000                                 [OPTION 1]
     5 00000000                                 [BITS 32]
     6 00000000                                 	EXTERN	_io_hlt
     7 00000000                                 	EXTERN	_memman_alloc_4k
     8 00000000                                 	EXTERN	_set_segmdesc
     9 00000000                                 	EXTERN	_load_tr
    10 00000000                                 	EXTERN	_timer_alloc
    11 00000000                                 	EXTERN	_timer_settime
    12 00000000                                 	EXTERN	_farjmp
    13 00000000                                 	EXTERN	_io_cli
    14 00000000                                 	EXTERN	_io_sti
    15 00000000                                 [FILE "mtask.c"]
    16                                          [SECTION .text]
    17 00000000                                 	GLOBAL	_task_now
    18 00000000                                 _task_now:
    19 00000000 A1 [0000000C]                   	MOV	EAX,DWORD [_taskctl]
    20 00000005 55                              	PUSH	EBP
    21 00000006 89 E5                           	MOV	EBP,ESP
    22 00000008 5D                              	POP	EBP
    23 00000009 8B 10                           	MOV	EDX,DWORD [EAX]
    24 0000000B 69 D2 00000198                  	IMUL	EDX,EDX,408
    25 00000011 8D 44 02 08                     	LEA	EAX,DWORD [8+EDX+EAX*1]
    26 00000015 8B 50 04                        	MOV	EDX,DWORD [4+EAX]
    27 00000018 8B 44 90 08                     	MOV	EAX,DWORD [8+EAX+EDX*4]
    28 0000001C C3                              	RET
    29 0000001D                                 	GLOBAL	_task_add
    30 0000001D                                 _task_add:
    31 0000001D 55                              	PUSH	EBP
    32 0000001E 89 E5                           	MOV	EBP,ESP
    33 00000020 8B 4D 08                        	MOV	ECX,DWORD [8+EBP]
    34 00000023 8B 51 08                        	MOV	EDX,DWORD [8+ECX]
    35 00000026 69 D2 00000198                  	IMUL	EDX,EDX,408
    36 0000002C 03 15 [0000000C]                	ADD	EDX,DWORD [_taskctl]
    37 00000032 8B 42 08                        	MOV	EAX,DWORD [8+EDX]
    38 00000035 89 4C 82 10                     	MOV	DWORD [16+EDX+EAX*4],ECX
    39 00000039 40                              	INC	EAX
    40 0000003A 89 42 08                        	MOV	DWORD [8+EDX],EAX
    41 0000003D C7 41 04 00000002               	MOV	DWORD [4+ECX],2
    42 00000044 5D                              	POP	EBP
    43 00000045 C3                              	RET
    44 00000046                                 	GLOBAL	_task_remove
    45 00000046                                 _task_remove:
    46 00000046 55                              	PUSH	EBP
    47 00000047 31 C9                           	XOR	ECX,ECX
    48 00000049 89 E5                           	MOV	EBP,ESP
    49 0000004B 53                              	PUSH	EBX
    50 0000004C 8B 5D 08                        	MOV	EBX,DWORD [8+EBP]
    51 0000004F 8B 43 08                        	MOV	EAX,DWORD [8+EBX]
    52 00000052 69 C0 00000198                  	IMUL	EAX,EAX,408
    53 00000058 03 05 [0000000C]                	ADD	EAX,DWORD [_taskctl]
    54 0000005E 8D 50 08                        	LEA	EDX,DWORD [8+EAX]
    55 00000061 3B 48 08                        	CMP	ECX,DWORD [8+EAX]
    56 00000064 7D 0B                           	JGE	L5
    57 00000066                                 L9:
    58 00000066 39 5C 8A 08                     	CMP	DWORD [8+EDX+ECX*4],EBX
    59 0000006A 74 05                           	JE	L5
    60 0000006C 41                              	INC	ECX
    61 0000006D 3B 0A                           	CMP	ECX,DWORD [EDX]
    62 0000006F 7C F5                           	JL	L9
    63 00000071                                 L5:
    64 00000071 8B 42 04                        	MOV	EAX,DWORD [4+EDX]
    65 00000074 FF 0A                           	DEC	DWORD [EDX]
    66 00000076 39 C1                           	CMP	ECX,EAX
    67 00000078 7D 04                           	JGE	L10
    68 0000007A 48                              	DEC	EAX
    69 0000007B 89 42 04                        	MOV	DWORD [4+EDX],EAX
    70 0000007E                                 L10:
    71 0000007E 8B 02                           	MOV	EAX,DWORD [EDX]
    72 00000080 39 42 04                        	CMP	DWORD [4+EDX],EAX
    73 00000083 7C 07                           	JL	L11
    74 00000085 C7 42 04 00000000               	MOV	DWORD [4+EDX],0
    75 0000008C                                 L11:
    76 0000008C C7 43 04 00000001               	MOV	DWORD [4+EBX],1
    77 00000093 8B 1A                           	MOV	EBX,DWORD [EDX]
    78 00000095 39 D9                           	CMP	ECX,EBX
    79 00000097 7D 0D                           	JGE	L19
    80 00000099                                 L16:
    81 00000099 8B 44 8A 0C                     	MOV	EAX,DWORD [12+EDX+ECX*4]
    82 0000009D 89 44 8A 08                     	MOV	DWORD [8+EDX+ECX*4],EAX
    83 000000A1 41                              	INC	ECX
    84 000000A2 39 D9                           	CMP	ECX,EBX
    85 000000A4 7C F3                           	JL	L16
    86 000000A6                                 L19:
    87 000000A6 5B                              	POP	EBX
    88 000000A7 5D                              	POP	EBP
    89 000000A8 C3                              	RET
    90 000000A9                                 	GLOBAL	_task_switchsub
    91 000000A9                                 _task_switchsub:
    92 000000A9 55                              	PUSH	EBP
    93 000000AA 31 C9                           	XOR	ECX,ECX
    94 000000AC 89 E5                           	MOV	EBP,ESP
    95 000000AE A1 [0000000C]                   	MOV	EAX,DWORD [_taskctl]
    96 000000B3 31 D2                           	XOR	EDX,EDX
    97 000000B5                                 L26:
    98 000000B5 83 7C 10 08 00                  	CMP	DWORD [8+EAX+EDX*1],0
    99 000000BA 7F 0C                           	JG	L22
   100 000000BC 41                              	INC	ECX
   101 000000BD 81 C2 00000198                  	ADD	EDX,408
   102 000000C3 83 F9 09                        	CMP	ECX,9
   103 000000C6 7E ED                           	JLE	L26
   104 000000C8                                 L22:
   105 000000C8 89 08                           	MOV	DWORD [EAX],ECX
   106 000000CA C6 40 04 00                     	MOV	BYTE [4+EAX],0
   107 000000CE 5D                              	POP	EBP
   108 000000CF C3                              	RET
   109 000000D0                                 	GLOBAL	_task_idle
   110 000000D0                                 _task_idle:
   111 000000D0 55                              	PUSH	EBP
   112 000000D1 89 E5                           	MOV	EBP,ESP
   113 000000D3                                 L29:
   114 000000D3 E8 [00000000]                   	CALL	_io_hlt
   115 000000D8 EB F9                           	JMP	L29
   116                                          [SECTION .data]
   117 00000000                                 LC0:
   118 00000000 73 79 73 74 65 6D 00            	DB	"system",0x00
   119 00000007                                 LC1:
   120 00000007 74 73 79 00                     	DB	"tsy",0x00
   121                                          [SECTION .text]
   122 000000DA                                 	GLOBAL	_task_init
   123 000000DA                                 _task_init:
   124 000000DA 55                              	PUSH	EBP
   125 000000DB 89 E5                           	MOV	EBP,ESP
   126 000000DD 57                              	PUSH	EDI
   127 000000DE 56                              	PUSH	ESI
   128 000000DF 31 FF                           	XOR	EDI,EDI
   129 000000E1 53                              	PUSH	EBX
   130 000000E2 31 F6                           	XOR	ESI,ESI
   131 000000E4 51                              	PUSH	ECX
   132 000000E5 BB 000003E7                     	MOV	EBX,999
   133 000000EA 68 00034C20                     	PUSH	216096
   134 000000EF FF 75 08                        	PUSH	DWORD [8+EBP]
   135 000000F2 E8 [00000000]                   	CALL	_memman_alloc_4k
   136 000000F7 A3 [0000000C]                   	MOV	DWORD [_taskctl],EAX
   137 000000FC 58                              	POP	EAX
   138 000000FD 5A                              	POP	EDX
   139 000000FE                                 L37:
   140 000000FE 89 FA                           	MOV	EDX,EDI
   141 00000100 8D 46 18                        	LEA	EAX,DWORD [24+ESI]
   142 00000103 03 15 [0000000C]                	ADD	EDX,DWORD [_taskctl]
   143 00000109 89 82 00000FF8                  	MOV	DWORD [4088+EDX],EAX
   144 0000010F 8D 86 00001F58                  	LEA	EAX,DWORD [8024+ESI]
   145 00000115 89 82 00001084                  	MOV	DWORD [4228+EDX],EAX
   146 0000011B 8D 86 00270018                  	LEA	EAX,DWORD [2555928+ESI]
   147 00000121 C7 82 00000FFC 00000000         	MOV	DWORD [4092+EDX],0
   148 0000012B 68 00000089                     	PUSH	137
   149 00000130 81 C2 00001024                  	ADD	EDX,4132
   150 00000136 52                              	PUSH	EDX
   151 00000137 6A 67                           	PUSH	103
   152 00000139 50                              	PUSH	EAX
   153 0000013A E8 [00000000]                   	CALL	_set_segmdesc
   154 0000013F A1 [0000000C]                   	MOV	EAX,DWORD [_taskctl]
   155 00000144 01 F8                           	ADD	EAX,EDI
   156 00000146 68 00000082                     	PUSH	130
   157 0000014B 05 0000108C                     	ADD	EAX,4236
   158 00000150 81 C7 000000D4                  	ADD	EDI,212
   159 00000156 50                              	PUSH	EAX
   160 00000157 8D 86 00271F58                  	LEA	EAX,DWORD [2563928+ESI]
   161 0000015D 6A 0F                           	PUSH	15
   162 0000015F 83 C6 08                        	ADD	ESI,8
   163 00000162 50                              	PUSH	EAX
   164 00000163 E8 [00000000]                   	CALL	_set_segmdesc
   165 00000168 83 C4 20                        	ADD	ESP,32
   166 0000016B 4B                              	DEC	EBX
   167 0000016C 79 90                           	JNS	L37
   168 0000016E 8B 15 [0000000C]                	MOV	EDX,DWORD [_taskctl]
   169 00000174 31 C9                           	XOR	ECX,ECX
   170 00000176 BB 00000009                     	MOV	EBX,9
   171 0000017B                                 L42:
   172 0000017B 8D 04 0A                        	LEA	EAX,DWORD [EDX+ECX*1]
   173 0000017E 81 C1 00000198                  	ADD	ECX,408
   174 00000184 4B                              	DEC	EBX
   175 00000185 C7 40 08 00000000               	MOV	DWORD [8+EAX],0
   176 0000018C C7 40 0C 00000000               	MOV	DWORD [12+EAX],0
   177 00000193 79 E6                           	JNS	L42
   178 00000195 C7 82 00034C18 00000000         	MOV	DWORD [216088+EDX],0
   179 0000019F C7 82 00034C1C 00000000         	MOV	DWORD [216092+EDX],0
   180 000001A9 BE [00000000]                   	MOV	ESI,LC0
   181 000001AE E8 000000E8                     	CALL	_task_alloc
   182 000001B3 89 C7                           	MOV	EDI,EAX
   183 000001B5 B9 00000007                     	MOV	ECX,7
   184 000001BA FC                              	CLD
   185 000001BB 81 C7 000000BE                  	ADD	EDI,190
   186 000001C1 89 45 F0                        	MOV	DWORD [-16+EBP],EAX
   187 000001C4 C7 40 04 00000002               	MOV	DWORD [4+EAX],2
   188 000001CB C7 40 0C 00000002               	MOV	DWORD [12+EAX],2
   189 000001D2 C7 40 08 00000000               	MOV	DWORD [8+EAX],0
   190 000001D9 F3                              	REP
   191 000001DA A4                              	MOVSB
   192 000001DB C7 80 000000D0 00000000         	MOV	DWORD [208+EAX],0
   193 000001E5 50                              	PUSH	EAX
   194 000001E6 E8 FFFFFE32                     	CALL	_task_add
   195 000001EB E8 FFFFFEB9                     	CALL	_task_switchsub
   196 000001F0 8B 55 F0                        	MOV	EDX,DWORD [-16+EBP]
   197 000001F3 FF 32                           	PUSH	DWORD [EDX]
   198 000001F5 E8 [00000000]                   	CALL	_load_tr
   199 000001FA 68 [00000007]                   	PUSH	LC1
   200 000001FF E8 [00000000]                   	CALL	_timer_alloc
   201 00000204 8B 55 F0                        	MOV	EDX,DWORD [-16+EBP]
   202 00000207 A3 [00000010]                   	MOV	DWORD [_task_timer],EAX
   203 0000020C FF 72 0C                        	PUSH	DWORD [12+EDX]
   204 0000020F 50                              	PUSH	EAX
   205 00000210 E8 [00000000]                   	CALL	_timer_settime
   206 00000215 E8 00000081                     	CALL	_task_alloc
   207 0000021A 68 00010000                     	PUSH	65536
   208 0000021F FF 75 08                        	PUSH	DWORD [8+EBP]
   209 00000222 89 C3                           	MOV	EBX,EAX
   210 00000224 E8 [00000000]                   	CALL	_memman_alloc_4k
   211 00000229 05 00010000                     	ADD	EAX,65536
   212 0000022E 89 43 64                        	MOV	DWORD [100+EBX],EAX
   213 00000231 C7 43 4C [000000D0]             	MOV	DWORD [76+EBX],_task_idle
   214 00000238 C7 43 74 00000008               	MOV	DWORD [116+EBX],8
   215 0000023F C7 43 78 00000010               	MOV	DWORD [120+EBX],16
   216 00000246 C7 43 7C 00000008               	MOV	DWORD [124+EBX],8
   217 0000024D C7 83 00000080 00000008         	MOV	DWORD [128+EBX],8
   218 00000257 C7 83 00000084 00000008         	MOV	DWORD [132+EBX],8
   219 00000261 C7 83 00000088 00000008         	MOV	DWORD [136+EBX],8
   220 0000026B C7 83 000000BE 656C6469         	MOV	DWORD [190+EBX],1701602409
   221 00000275 C6 83 000000C2 00               	MOV	BYTE [194+EBX],0
   222 0000027C C7 83 000000D0 00000000         	MOV	DWORD [208+EBX],0
   223 00000286 6A 01                           	PUSH	1
   224 00000288 6A 09                           	PUSH	9
   225 0000028A 53                              	PUSH	EBX
   226 0000028B E8 000000EA                     	CALL	_task_run
   227 00000290 8B 45 F0                        	MOV	EAX,DWORD [-16+EBP]
   228 00000293 8D 65 F4                        	LEA	ESP,DWORD [-12+EBP]
   229 00000296 5B                              	POP	EBX
   230 00000297 5E                              	POP	ESI
   231 00000298 5F                              	POP	EDI
   232 00000299 5D                              	POP	EBP
   233 0000029A C3                              	RET
   234                                          [SECTION .data]
   235 0000000B                                 LC2:
   236 0000000B 00                              	DB	0x00
   237                                          [SECTION .text]
   238 0000029B                                 	GLOBAL	_task_alloc
   239 0000029B                                 _task_alloc:
   240 0000029B 55                              	PUSH	EBP
   241 0000029C 31 C0                           	XOR	EAX,EAX
   242 0000029E 89 E5                           	MOV	EBP,ESP
   243 000002A0 31 C9                           	XOR	ECX,ECX
   244 000002A2                                 L54:
   245 000002A2 89 CA                           	MOV	EDX,ECX
   246 000002A4 03 15 [0000000C]                	ADD	EDX,DWORD [_taskctl]
   247 000002AA 83 BA 00000FFC 00               	CMP	DWORD [4092+EDX],0
   248 000002B1 74 12                           	JE	L57
   249 000002B3 40                              	INC	EAX
   250 000002B4 81 C1 000000D4                  	ADD	ECX,212
   251 000002BA 3D 000003E7                     	CMP	EAX,999
   252 000002BF 7E E1                           	JLE	L54
   253 000002C1 31 C0                           	XOR	EAX,EAX
   254 000002C3                                 L47:
   255 000002C3 5D                              	POP	EBP
   256 000002C4 C3                              	RET
   257 000002C5                                 L57:
   258 000002C5 81 C2 00000FF8                  	ADD	EDX,4088
   259 000002CB C6 82 000000BC 00               	MOV	BYTE [188+EDX],0
   260 000002D2 C6 82 000000BD 00               	MOV	BYTE [189+EDX],0
   261 000002D9 8B 0D [0000000C]                	MOV	ECX,DWORD [_taskctl]
   262 000002DF C7 42 04 00000001               	MOV	DWORD [4+EDX],1
   263 000002E6 C7 42 50 00000202               	MOV	DWORD [80+EDX],514
   264 000002ED C7 42 54 00000000               	MOV	DWORD [84+EDX],0
   265 000002F4 C7 42 58 00000000               	MOV	DWORD [88+EDX],0
   266 000002FB C7 42 5C 00000000               	MOV	DWORD [92+EDX],0
   267 00000302 C7 42 60 00000000               	MOV	DWORD [96+EDX],0
   268 00000309 C7 42 68 00000000               	MOV	DWORD [104+EDX],0
   269 00000310 C7 42 6C 00000000               	MOV	DWORD [108+EDX],0
   270 00000317 C7 42 70 00000000               	MOV	DWORD [112+EDX],0
   271 0000031E C7 42 74 00000000               	MOV	DWORD [116+EDX],0
   272 00000325 C7 82 00000080 00000000         	MOV	DWORD [128+EDX],0
   273 0000032F C7 82 00000084 00000000         	MOV	DWORD [132+EDX],0
   274 00000339 C7 82 00000088 00000000         	MOV	DWORD [136+EDX],0
   275 00000343 C7 82 00000090 40000000         	MOV	DWORD [144+EDX],1073741824
   276 0000034D C7 42 34 00000000               	MOV	DWORD [52+EDX],0
   277 00000354 C7 82 000000B8 [0000000B]       	MOV	DWORD [184+EDX],LC2
   278 0000035E 3B 81 00034C18                  	CMP	EAX,DWORD [216088+ECX]
   279 00000364 7C 07                           	JL	L53
   280 00000366 40                              	INC	EAX
   281 00000367 89 81 00034C18                  	MOV	DWORD [216088+ECX],EAX
   282 0000036D                                 L53:
   283 0000036D FF 81 00034C1C                  	INC	DWORD [216092+ECX]
   284 00000373 89 D0                           	MOV	EAX,EDX
   285 00000375 E9 FFFFFF49                     	JMP	L47
   286 0000037A                                 	GLOBAL	_task_run
   287 0000037A                                 _task_run:
   288 0000037A 55                              	PUSH	EBP
   289 0000037B 89 E5                           	MOV	EBP,ESP
   290 0000037D 56                              	PUSH	ESI
   291 0000037E 53                              	PUSH	EBX
   292 0000037F 8B 75 0C                        	MOV	ESI,DWORD [12+EBP]
   293 00000382 8B 45 10                        	MOV	EAX,DWORD [16+EBP]
   294 00000385 8B 5D 08                        	MOV	EBX,DWORD [8+EBP]
   295 00000388 85 F6                           	TEST	ESI,ESI
   296 0000038A 78 3B                           	JS	L63
   297 0000038C                                 L59:
   298 0000038C 85 C0                           	TEST	EAX,EAX
   299 0000038E 7E 03                           	JLE	L60
   300 00000390 89 43 0C                        	MOV	DWORD [12+EBX],EAX
   301 00000393                                 L60:
   302 00000393 83 7B 04 02                     	CMP	DWORD [4+EBX],2
   303 00000397 74 20                           	JE	L64
   304 00000399                                 L61:
   305 00000399 83 7B 04 02                     	CMP	DWORD [4+EBX],2
   306 0000039D 74 0A                           	JE	L62
   307 0000039F 89 73 08                        	MOV	DWORD [8+EBX],ESI
   308 000003A2 53                              	PUSH	EBX
   309 000003A3 E8 FFFFFC75                     	CALL	_task_add
   310 000003A8 5B                              	POP	EBX
   311 000003A9                                 L62:
   312 000003A9 A1 [0000000C]                   	MOV	EAX,DWORD [_taskctl]
   313 000003AE C6 40 04 01                     	MOV	BYTE [4+EAX],1
   314 000003B2 8D 65 F8                        	LEA	ESP,DWORD [-8+EBP]
   315 000003B5 5B                              	POP	EBX
   316 000003B6 5E                              	POP	ESI
   317 000003B7 5D                              	POP	EBP
   318 000003B8 C3                              	RET
   319 000003B9                                 L64:
   320 000003B9 39 73 08                        	CMP	DWORD [8+EBX],ESI
   321 000003BC 74 DB                           	JE	L61
   322 000003BE 53                              	PUSH	EBX
   323 000003BF E8 FFFFFC82                     	CALL	_task_remove
   324 000003C4 58                              	POP	EAX
   325 000003C5 EB D2                           	JMP	L61
   326 000003C7                                 L63:
   327 000003C7 8B 73 08                        	MOV	ESI,DWORD [8+EBX]
   328 000003CA EB C0                           	JMP	L59
   329 000003CC                                 	GLOBAL	_task_sleep
   330 000003CC                                 _task_sleep:
   331 000003CC 55                              	PUSH	EBP
   332 000003CD 89 E5                           	MOV	EBP,ESP
   333 000003CF 56                              	PUSH	ESI
   334 000003D0 53                              	PUSH	EBX
   335 000003D1 8B 75 08                        	MOV	ESI,DWORD [8+EBP]
   336 000003D4 83 7E 04 02                     	CMP	DWORD [4+ESI],2
   337 000003D8 74 07                           	JE	L68
   338 000003DA                                 L65:
   339 000003DA 8D 65 F8                        	LEA	ESP,DWORD [-8+EBP]
   340 000003DD 5B                              	POP	EBX
   341 000003DE 5E                              	POP	ESI
   342 000003DF 5D                              	POP	EBP
   343 000003E0 C3                              	RET
   344 000003E1                                 L68:
   345 000003E1 E8 FFFFFC1A                     	CALL	_task_now
   346 000003E6 56                              	PUSH	ESI
   347 000003E7 89 C3                           	MOV	EBX,EAX
   348 000003E9 E8 FFFFFC58                     	CALL	_task_remove
   349 000003EE 59                              	POP	ECX
   350 000003EF 39 DE                           	CMP	ESI,EBX
   351 000003F1 75 E7                           	JNE	L65
   352 000003F3 E8 FFFFFCB1                     	CALL	_task_switchsub
   353 000003F8 E8 FFFFFC03                     	CALL	_task_now
   354 000003FD FF 30                           	PUSH	DWORD [EAX]
   355 000003FF 6A 00                           	PUSH	0
   356 00000401 E8 [00000000]                   	CALL	_farjmp
   357 00000406 58                              	POP	EAX
   358 00000407 5A                              	POP	EDX
   359 00000408 EB D0                           	JMP	L65
   360 0000040A                                 	GLOBAL	_task_switch
   361 0000040A                                 _task_switch:
   362 0000040A 55                              	PUSH	EBP
   363 0000040B 89 E5                           	MOV	EBP,ESP
   364 0000040D 56                              	PUSH	ESI
   365 0000040E 53                              	PUSH	EBX
   366 0000040F 8B 1D [0000000C]                	MOV	EBX,DWORD [_taskctl]
   367 00000415 8B 13                           	MOV	EDX,DWORD [EBX]
   368 00000417 69 D2 00000198                  	IMUL	EDX,EDX,408
   369 0000041D 8D 14 1A                        	LEA	EDX,DWORD [EDX+EBX*1]
   370 00000420 8D 4A 08                        	LEA	ECX,DWORD [8+EDX]
   371 00000423 8B 41 04                        	MOV	EAX,DWORD [4+ECX]
   372 00000426 8B 74 81 08                     	MOV	ESI,DWORD [8+ECX+EAX*4]
   373 0000042A 40                              	INC	EAX
   374 0000042B 89 41 04                        	MOV	DWORD [4+ECX],EAX
   375 0000042E 3B 42 08                        	CMP	EAX,DWORD [8+EDX]
   376 00000431 74 4C                           	JE	L73
   377 00000433                                 L70:
   378 00000433 80 7B 04 00                     	CMP	BYTE [4+EBX],0
   379 00000437 75 2D                           	JNE	L74
   380 00000439                                 L71:
   381 00000439 8B 41 04                        	MOV	EAX,DWORD [4+ECX]
   382 0000043C 8B 5C 81 08                     	MOV	EBX,DWORD [8+ECX+EAX*4]
   383 00000440 FF 73 0C                        	PUSH	DWORD [12+EBX]
   384 00000443 FF 35 [00000010]                	PUSH	DWORD [_task_timer]
   385 00000449 E8 [00000000]                   	CALL	_timer_settime
   386 0000044E 39 F3                           	CMP	EBX,ESI
   387 00000450 58                              	POP	EAX
   388 00000451 5A                              	POP	EDX
   389 00000452 74 0B                           	JE	L69
   390 00000454 FF 33                           	PUSH	DWORD [EBX]
   391 00000456 6A 00                           	PUSH	0
   392 00000458 E8 [00000000]                   	CALL	_farjmp
   393 0000045D 5B                              	POP	EBX
   394 0000045E 5E                              	POP	ESI
   395 0000045F                                 L69:
   396 0000045F 8D 65 F8                        	LEA	ESP,DWORD [-8+EBP]
   397 00000462 5B                              	POP	EBX
   398 00000463 5E                              	POP	ESI
   399 00000464 5D                              	POP	EBP
   400 00000465 C3                              	RET
   401 00000466                                 L74:
   402 00000466 E8 FFFFFC3E                     	CALL	_task_switchsub
   403 0000046B 8B 15 [0000000C]                	MOV	EDX,DWORD [_taskctl]
   404 00000471 8B 02                           	MOV	EAX,DWORD [EDX]
   405 00000473 69 C0 00000198                  	IMUL	EAX,EAX,408
   406 00000479 8D 4C 10 08                     	LEA	ECX,DWORD [8+EAX+EDX*1]
   407 0000047D EB BA                           	JMP	L71
   408 0000047F                                 L73:
   409 0000047F C7 41 04 00000000               	MOV	DWORD [4+ECX],0
   410 00000486 EB AB                           	JMP	L70
   411 00000488                                 	GLOBAL	_task_free
   412 00000488                                 _task_free:
   413 00000488 55                              	PUSH	EBP
   414 00000489 89 E5                           	MOV	EBP,ESP
   415 0000048B 53                              	PUSH	EBX
   416 0000048C 8B 5D 08                        	MOV	EBX,DWORD [8+EBP]
   417 0000048F E8 [00000000]                   	CALL	_io_cli
   418 00000494 C7 43 04 00000000               	MOV	DWORD [4+EBX],0
   419 0000049B E8 [00000000]                   	CALL	_io_sti
   420 000004A0 8B 0D [0000000C]                	MOV	ECX,DWORD [_taskctl]
   421 000004A6 29 CB                           	SUB	EBX,ECX
   422 000004A8 8D 93 FFFFF008                  	LEA	EDX,DWORD [-4088+EBX]
   423 000004AE C1 FA 02                        	SAR	EDX,2
   424 000004B1 69 D2 8C13521D                  	IMUL	EDX,EDX,-1944890851
   425 000004B7 8D 42 01                        	LEA	EAX,DWORD [1+EDX]
   426 000004BA 3B 81 00034C18                  	CMP	EAX,DWORD [216088+ECX]
   427 000004C0 7C 2B                           	JL	L76
   428 000004C2 4A                              	DEC	EDX
   429 000004C3 78 1C                           	JS	L78
   430 000004C5 89 D0                           	MOV	EAX,EDX
   431 000004C7 69 C0 000000D4                  	IMUL	EAX,EAX,212
   432 000004CD 8D 84 01 00000FFC               	LEA	EAX,DWORD [4092+ECX+EAX*1]
   433 000004D4                                 L82:
   434 000004D4 83 38 00                        	CMP	DWORD [EAX],0
   435 000004D7 75 08                           	JNE	L78
   436 000004D9 2D 000000D4                     	SUB	EAX,212
   437 000004DE 4A                              	DEC	EDX
   438 000004DF 79 F3                           	JNS	L82
   439 000004E1                                 L78:
   440 000004E1 A1 [0000000C]                   	MOV	EAX,DWORD [_taskctl]
   441 000004E6 42                              	INC	EDX
   442 000004E7 89 90 00034C18                  	MOV	DWORD [216088+EAX],EDX
   443 000004ED                                 L76:
   444 000004ED A1 [0000000C]                   	MOV	EAX,DWORD [_taskctl]
   445 000004F2 FF 88 00034C1C                  	DEC	DWORD [216092+EAX]
   446 000004F8 5B                              	POP	EBX
   447 000004F9 5D                              	POP	EBP
   448 000004FA C3                              	RET
   449 000004FB                                 	GLOBAL	_taskctl
   450                                          [SECTION .data]
   451 0000000C                                 	ALIGNB	4
   452 0000000C                                 _taskctl:
   453 0000000C 00 00 00 00                     	RESB	4
   454 00000010                                 	GLOBAL	_task_timer
   455                                          [SECTION .data]
   456 00000010                                 	ALIGNB	4
   457 00000010                                 _task_timer:
   458 00000010 00 00 00 00                     	RESB	4
