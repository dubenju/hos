     1 00000000                                 [FORMAT "WCOFF"]
     2 00000000                                 [INSTRSET "i486p"]
     3 00000000                                 [OPTIMIZE 1]
     4 00000000                                 [OPTION 1]
     5 00000000                                 [BITS 32]
     6 00000000                                 	EXTERN	_memman_alloc_4k
     7 00000000                                 	EXTERN	_memman_free_4k
     8 00000000                                 	EXTERN	_table_16_65536
     9 00000000                                 [FILE "sheet.c"]
    10                                          [SECTION .text]
    11 00000000                                 	GLOBAL	_shtctl_init
    12 00000000                                 _shtctl_init:
    13 00000000 55                              	PUSH	EBP
    14 00000001 89 E5                           	MOV	EBP,ESP
    15 00000003 57                              	PUSH	EDI
    16 00000004 56                              	PUSH	ESI
    17 00000005 53                              	PUSH	EBX
    18 00000006 8B 75 08                        	MOV	ESI,DWORD [8+EBP]
    19 00000009 68 00003014                     	PUSH	12308
    20 0000000E 8B 7D 10                        	MOV	EDI,DWORD [16+EBP]
    21 00000011 56                              	PUSH	ESI
    22 00000012 E8 [00000000]                   	CALL	_memman_alloc_4k
    23 00000017 89 C3                           	MOV	EBX,EAX
    24 00000019 58                              	POP	EAX
    25 0000001A 5A                              	POP	EDX
    26 0000001B 85 DB                           	TEST	EBX,EBX
    27 0000001D 74 48                           	JE	L3
    28 0000001F 8B 45 14                        	MOV	EAX,DWORD [20+EBP]
    29 00000022 0F AF C7                        	IMUL	EAX,EDI
    30 00000025 50                              	PUSH	EAX
    31 00000026 56                              	PUSH	ESI
    32 00000027 E8 [00000000]                   	CALL	_memman_alloc_4k
    33 0000002C 85 C0                           	TEST	EAX,EAX
    34 0000002E 89 43 04                        	MOV	DWORD [4+EBX],EAX
    35 00000031 5A                              	POP	EDX
    36 00000032 59                              	POP	ECX
    37 00000033 74 3C                           	JE	L11
    38 00000035 8B 45 0C                        	MOV	EAX,DWORD [12+EBP]
    39 00000038 89 7B 08                        	MOV	DWORD [8+EBX],EDI
    40 0000003B 89 03                           	MOV	DWORD [EBX],EAX
    41 0000003D BA 000000FF                     	MOV	EDX,255
    42 00000042 8B 45 14                        	MOV	EAX,DWORD [20+EBP]
    43 00000045 89 43 0C                        	MOV	DWORD [12+EBX],EAX
    44 00000048 89 D8                           	MOV	EAX,EBX
    45 0000004A C7 43 10 FFFFFFFF               	MOV	DWORD [16+EBX],-1
    46 00000051                                 L9:
    47 00000051 C7 80 00000430 00000000         	MOV	DWORD [1072+EAX],0
    48 0000005B 89 98 00000434                  	MOV	DWORD [1076+EAX],EBX
    49 00000061 83 C0 2C                        	ADD	EAX,44
    50 00000064 4A                              	DEC	EDX
    51 00000065 79 EA                           	JNS	L9
    52 00000067                                 L3:
    53 00000067 8D 65 F4                        	LEA	ESP,DWORD [-12+EBP]
    54 0000006A 89 D8                           	MOV	EAX,EBX
    55 0000006C 5B                              	POP	EBX
    56 0000006D 5E                              	POP	ESI
    57 0000006E 5F                              	POP	EDI
    58 0000006F 5D                              	POP	EBP
    59 00000070 C3                              	RET
    60 00000071                                 L11:
    61 00000071 68 00003014                     	PUSH	12308
    62 00000076 53                              	PUSH	EBX
    63 00000077 31 DB                           	XOR	EBX,EBX
    64 00000079 56                              	PUSH	ESI
    65 0000007A E8 [00000000]                   	CALL	_memman_free_4k
    66 0000007F 83 C4 0C                        	ADD	ESP,12
    67 00000082 EB E3                           	JMP	L3
    68 00000084                                 	GLOBAL	_sheet_alloc
    69 00000084                                 _sheet_alloc:
    70 00000084 55                              	PUSH	EBP
    71 00000085 31 D2                           	XOR	EDX,EDX
    72 00000087 89 E5                           	MOV	EBP,ESP
    73 00000089 8B 45 08                        	MOV	EAX,DWORD [8+EBP]
    74 0000008C 05 00000414                     	ADD	EAX,1044
    75 00000091                                 L18:
    76 00000091 83 78 1C 00                     	CMP	DWORD [28+EAX],0
    77 00000095 74 10                           	JE	L21
    78 00000097 42                              	INC	EDX
    79 00000098 83 C0 2C                        	ADD	EAX,44
    80 0000009B 81 FA 000000FF                  	CMP	EDX,255
    81 000000A1 7E EE                           	JLE	L18
    82 000000A3 31 C0                           	XOR	EAX,EAX
    83 000000A5                                 L12:
    84 000000A5 5D                              	POP	EBP
    85 000000A6 C3                              	RET
    86 000000A7                                 L21:
    87 000000A7 C7 40 1C 00000001               	MOV	DWORD [28+EAX],1
    88 000000AE C7 40 18 FFFFFFFF               	MOV	DWORD [24+EAX],-1
    89 000000B5 C7 40 24 00000000               	MOV	DWORD [36+EAX],0
    90 000000BC EB E7                           	JMP	L12
    91 000000BE                                 	GLOBAL	_sheet_setbuf
    92 000000BE                                 _sheet_setbuf:
    93 000000BE 55                              	PUSH	EBP
    94 000000BF 89 E5                           	MOV	EBP,ESP
    95 000000C1 8B 55 08                        	MOV	EDX,DWORD [8+EBP]
    96 000000C4 8B 45 0C                        	MOV	EAX,DWORD [12+EBP]
    97 000000C7 8B 4D 18                        	MOV	ECX,DWORD [24+EBP]
    98 000000CA 89 02                           	MOV	DWORD [EDX],EAX
    99 000000CC 83 F9 FF                        	CMP	ECX,-1
   100 000000CF 8B 45 10                        	MOV	EAX,DWORD [16+EBP]
   101 000000D2 89 42 04                        	MOV	DWORD [4+EDX],EAX
   102 000000D5 8B 45 14                        	MOV	EAX,DWORD [20+EBP]
   103 000000D8 89 42 08                        	MOV	DWORD [8+EDX],EAX
   104 000000DB 74 0D                           	JE	L23
   105 000000DD 0F B7 84 09 [00000000]          	MOVZX	EAX,WORD [_table_16_65536+ECX+ECX*1]
   106 000000E5 89 42 14                        	MOV	DWORD [20+EDX],EAX
   107 000000E8                                 L22:
   108 000000E8 5D                              	POP	EBP
   109 000000E9 C3                              	RET
   110 000000EA                                 L23:
   111 000000EA C7 42 14 FFFFFFFF               	MOV	DWORD [20+EDX],-1
   112 000000F1 EB F5                           	JMP	L22
   113 000000F3                                 	GLOBAL	_sheet_refreshmap
   114 000000F3                                 _sheet_refreshmap:
   115 000000F3 55                              	PUSH	EBP
   116 000000F4 89 E5                           	MOV	EBP,ESP
   117 000000F6 57                              	PUSH	EDI
   118 000000F7 56                              	PUSH	ESI
   119 000000F8 53                              	PUSH	EBX
   120 000000F9 83 EC 30                        	SUB	ESP,48
   121 000000FC 8B 45 08                        	MOV	EAX,DWORD [8+EBP]
   122 000000FF 83 7D 0C 00                     	CMP	DWORD [12+EBP],0
   123 00000103 8B 40 04                        	MOV	EAX,DWORD [4+EAX]
   124 00000106 89 45 D8                        	MOV	DWORD [-40+EBP],EAX
   125 00000109 0F 88 00000203                  	JS	L85
   126 0000010F                                 L26:
   127 0000010F 83 7D 10 00                     	CMP	DWORD [16+EBP],0
   128 00000113 0F 88 000001ED                  	JS	L86
   129 00000119                                 L27:
   130 00000119 8B 55 08                        	MOV	EDX,DWORD [8+EBP]
   131 0000011C 8B 42 08                        	MOV	EAX,DWORD [8+EDX]
   132 0000011F 39 45 14                        	CMP	DWORD [20+EBP],EAX
   133 00000122 7E 03                           	JLE	L28
   134 00000124 89 45 14                        	MOV	DWORD [20+EBP],EAX
   135 00000127                                 L28:
   136 00000127 8B 4D 08                        	MOV	ECX,DWORD [8+EBP]
   137 0000012A 8B 41 0C                        	MOV	EAX,DWORD [12+ECX]
   138 0000012D 39 45 18                        	CMP	DWORD [24+EBP],EAX
   139 00000130 7E 03                           	JLE	L29
   140 00000132 89 45 18                        	MOV	DWORD [24+EBP],EAX
   141 00000135                                 L29:
   142 00000135 8B 75 08                        	MOV	ESI,DWORD [8+EBP]
   143 00000138 8B 5D 1C                        	MOV	EBX,DWORD [28+EBP]
   144 0000013B 89 5D F0                        	MOV	DWORD [-16+EBP],EBX
   145 0000013E 3B 5E 10                        	CMP	EBX,DWORD [16+ESI]
   146 00000141 0F 8F 000000DA                  	JG	L75
   147 00000147                                 L73:
   148 00000147 8B 55 08                        	MOV	EDX,DWORD [8+EBP]
   149 0000014A 8B 45 F0                        	MOV	EAX,DWORD [-16+EBP]
   150 0000014D 8B 75 18                        	MOV	ESI,DWORD [24+EBP]
   151 00000150 8B 5D 14                        	MOV	EBX,DWORD [20+EBP]
   152 00000153 8B 7C 82 14                     	MOV	EDI,DWORD [20+EDX+EAX*4]
   153 00000157 89 F8                           	MOV	EAX,EDI
   154 00000159 29 D0                           	SUB	EAX,EDX
   155 0000015B 8B 0F                           	MOV	ECX,DWORD [EDI]
   156 0000015D 2D 00000414                     	SUB	EAX,1044
   157 00000162 89 4D D4                        	MOV	DWORD [-44+EBP],ECX
   158 00000165 C1 F8 02                        	SAR	EAX,2
   159 00000168 8B 4D 10                        	MOV	ECX,DWORD [16+EBP]
   160 0000016B 69 C0 BA2E8BA3                  	IMUL	EAX,EAX,-1171354717
   161 00000171 88 45 DF                        	MOV	BYTE [-33+EBP],AL
   162 00000174 8B 57 0C                        	MOV	EDX,DWORD [12+EDI]
   163 00000177 8B 47 10                        	MOV	EAX,DWORD [16+EDI]
   164 0000017A 29 D3                           	SUB	EBX,EDX
   165 0000017C 29 C6                           	SUB	ESI,EAX
   166 0000017E 29 C1                           	SUB	ECX,EAX
   167 00000180 8B 45 0C                        	MOV	EAX,DWORD [12+EBP]
   168 00000183 89 5D E8                        	MOV	DWORD [-24+EBP],EBX
   169 00000186 29 D0                           	SUB	EAX,EDX
   170 00000188 89 75 E4                        	MOV	DWORD [-28+EBP],ESI
   171 0000018B 89 45 EC                        	MOV	DWORD [-20+EBP],EAX
   172 0000018E 0F 88 00000166                  	JS	L87
   173 00000194                                 L34:
   174 00000194 85 C9                           	TEST	ECX,ECX
   175 00000196 0F 88 00000157                  	JS	L88
   176 0000019C                                 L35:
   177 0000019C 8B 47 04                        	MOV	EAX,DWORD [4+EDI]
   178 0000019F 39 45 E8                        	CMP	DWORD [-24+EBP],EAX
   179 000001A2 7E 03                           	JLE	L36
   180 000001A4 89 45 E8                        	MOV	DWORD [-24+EBP],EAX
   181 000001A7                                 L36:
   182 000001A7 8B 47 08                        	MOV	EAX,DWORD [8+EDI]
   183 000001AA 39 45 E4                        	CMP	DWORD [-28+EBP],EAX
   184 000001AD 7E 03                           	JLE	L37
   185 000001AF 89 45 E4                        	MOV	DWORD [-28+EBP],EAX
   186 000001B2                                 L37:
   187 000001B2 83 7F 14 FF                     	CMP	DWORD [20+EDI],-1
   188 000001B6 74 71                           	JE	L89
   189 000001B8 89 CA                           	MOV	EDX,ECX
   190 000001BA 3B 4D E4                        	CMP	ECX,DWORD [-28+EBP]
   191 000001BD 7D 50                           	JGE	L32
   192 000001BF                                 L72:
   193 000001BF 8B 47 10                        	MOV	EAX,DWORD [16+EDI]
   194 000001C2 8B 4D EC                        	MOV	ECX,DWORD [-20+EBP]
   195 000001C5 01 D0                           	ADD	EAX,EDX
   196 000001C7 3B 4D E8                        	CMP	ECX,DWORD [-24+EBP]
   197 000001CA 89 45 C4                        	MOV	DWORD [-60+EBP],EAX
   198 000001CD 7D 3A                           	JGE	L84
   199 000001CF                                 L71:
   200 000001CF 89 D0                           	MOV	EAX,EDX
   201 000001D1 8B 75 D4                        	MOV	ESI,DWORD [-44+EBP]
   202 000001D4 0F AF 47 04                     	IMUL	EAX,DWORD [4+EDI]
   203 000001D8 01 C8                           	ADD	EAX,ECX
   204 000001DA 8B 5F 0C                        	MOV	EBX,DWORD [12+EDI]
   205 000001DD 01 CB                           	ADD	EBX,ECX
   206 000001DF 0F B7 34 46                     	MOVZX	ESI,WORD [ESI+EAX*2]
   207 000001E3 89 5D C8                        	MOV	DWORD [-56+EBP],EBX
   208 000001E6 3B 77 14                        	CMP	ESI,DWORD [20+EDI]
   209 000001E9 74 18                           	JE	L68
   210 000001EB 8B 45 08                        	MOV	EAX,DWORD [8+EBP]
   211 000001EE 8B 5D C4                        	MOV	EBX,DWORD [-60+EBP]
   212 000001F1 8B 75 C8                        	MOV	ESI,DWORD [-56+EBP]
   213 000001F4 0F AF 58 08                     	IMUL	EBX,DWORD [8+EAX]
   214 000001F8 01 DE                           	ADD	ESI,EBX
   215 000001FA 8A 45 DF                        	MOV	AL,BYTE [-33+EBP]
   216 000001FD 8B 5D D8                        	MOV	EBX,DWORD [-40+EBP]
   217 00000200 88 04 1E                        	MOV	BYTE [ESI+EBX*1],AL
   218 00000203                                 L68:
   219 00000203 41                              	INC	ECX
   220 00000204 3B 4D E8                        	CMP	ECX,DWORD [-24+EBP]
   221 00000207 7C C6                           	JL	L71
   222 00000209                                 L84:
   223 00000209 42                              	INC	EDX
   224 0000020A 3B 55 E4                        	CMP	EDX,DWORD [-28+EBP]
   225 0000020D 7C B0                           	JL	L72
   226 0000020F                                 L32:
   227 0000020F 8B 45 08                        	MOV	EAX,DWORD [8+EBP]
   228 00000212 FF 45 F0                        	INC	DWORD [-16+EBP]
   229 00000215 8B 75 F0                        	MOV	ESI,DWORD [-16+EBP]
   230 00000218 3B 70 10                        	CMP	ESI,DWORD [16+EAX]
   231 0000021B 0F 8E FFFFFF26                  	JLE	L73
   232 00000221                                 L75:
   233 00000221 83 C4 30                        	ADD	ESP,48
   234 00000224 5B                              	POP	EBX
   235 00000225 5E                              	POP	ESI
   236 00000226 5F                              	POP	EDI
   237 00000227 5D                              	POP	EBP
   238 00000228 C3                              	RET
   239 00000229                                 L89:
   240 00000229 83 E2 03                        	AND	EDX,3
   241 0000022C 75 7F                           	JNE	L39
   242 0000022E F7 45 EC 00000003               	TEST	DWORD [-20+EBP],3
   243 00000235 75 76                           	JNE	L39
   244 00000237 F7 45 E8 00000003               	TEST	DWORD [-24+EBP],3
   245 0000023E 75 6D                           	JNE	L39
   246 00000240 8B 55 EC                        	MOV	EDX,DWORD [-20+EBP]
   247 00000243 29 55 E8                        	SUB	DWORD [-24+EBP],EDX
   248 00000246 BA 00000004                     	MOV	EDX,4
   249 0000024B 89 D3                           	MOV	EBX,EDX
   250 0000024D 8B 45 E8                        	MOV	EAX,DWORD [-24+EBP]
   251 00000250 99                              	CDQ
   252 00000251 F7 FB                           	IDIV	EBX
   253 00000253 89 45 D0                        	MOV	DWORD [-48+EBP],EAX
   254 00000256 89 CA                           	MOV	EDX,ECX
   255 00000258 0F B6 45 DF                     	MOVZX	EAX,BYTE [-33+EBP]
   256 0000025C 89 C6                           	MOV	ESI,EAX
   257 0000025E C1 E6 08                        	SAL	ESI,8
   258 00000261 09 C6                           	OR	ESI,EAX
   259 00000263 C1 E0 10                        	SAL	EAX,16
   260 00000266 09 C6                           	OR	ESI,EAX
   261 00000268 C1 E0 08                        	SAL	EAX,8
   262 0000026B 09 C6                           	OR	ESI,EAX
   263 0000026D 3B 4D E4                        	CMP	ECX,DWORD [-28+EBP]
   264 00000270 89 75 E0                        	MOV	DWORD [-32+EBP],ESI
   265 00000273 7D 9A                           	JGE	L32
   266 00000275                                 L49:
   267 00000275 8B 47 10                        	MOV	EAX,DWORD [16+EDI]
   268 00000278 8B 5D 08                        	MOV	EBX,DWORD [8+EBP]
   269 0000027B 01 D0                           	ADD	EAX,EDX
   270 0000027D 8B 4D EC                        	MOV	ECX,DWORD [-20+EBP]
   271 00000280 0F AF 43 08                     	IMUL	EAX,DWORD [8+EBX]
   272 00000284 03 4F 0C                        	ADD	ECX,DWORD [12+EDI]
   273 00000287 89 45 C4                        	MOV	DWORD [-60+EBP],EAX
   274 0000028A 01 C8                           	ADD	EAX,ECX
   275 0000028C 31 C9                           	XOR	ECX,ECX
   276 0000028E 03 45 D8                        	ADD	EAX,DWORD [-40+EBP]
   277 00000291 3B 4D D0                        	CMP	ECX,DWORD [-48+EBP]
   278 00000294 7D 0C                           	JGE	L78
   279 00000296                                 L48:
   280 00000296 8B 75 E0                        	MOV	ESI,DWORD [-32+EBP]
   281 00000299 89 34 88                        	MOV	DWORD [EAX+ECX*4],ESI
   282 0000029C 41                              	INC	ECX
   283 0000029D 3B 4D D0                        	CMP	ECX,DWORD [-48+EBP]
   284 000002A0 7C F4                           	JL	L48
   285 000002A2                                 L78:
   286 000002A2 42                              	INC	EDX
   287 000002A3 3B 55 E4                        	CMP	EDX,DWORD [-28+EBP]
   288 000002A6 7C CD                           	JL	L49
   289 000002A8 E9 FFFFFF62                     	JMP	L32
   290 000002AD                                 L39:
   291 000002AD 89 CA                           	MOV	EDX,ECX
   292 000002AF 3B 4D E4                        	CMP	ECX,DWORD [-28+EBP]
   293 000002B2 0F 8D FFFFFF57                  	JGE	L32
   294 000002B8                                 L60:
   295 000002B8 8B 47 10                        	MOV	EAX,DWORD [16+EDI]
   296 000002BB 8B 4D EC                        	MOV	ECX,DWORD [-20+EBP]
   297 000002BE 01 D0                           	ADD	EAX,EDX
   298 000002C0 3B 4D E8                        	CMP	ECX,DWORD [-24+EBP]
   299 000002C3 89 45 C4                        	MOV	DWORD [-60+EBP],EAX
   300 000002C6 7D 20                           	JGE	L81
   301 000002C8                                 L59:
   302 000002C8 8B 75 08                        	MOV	ESI,DWORD [8+EBP]
   303 000002CB 8B 45 C4                        	MOV	EAX,DWORD [-60+EBP]
   304 000002CE 8B 5F 0C                        	MOV	EBX,DWORD [12+EDI]
   305 000002D1 0F AF 46 08                     	IMUL	EAX,DWORD [8+ESI]
   306 000002D5 01 CB                           	ADD	EBX,ECX
   307 000002D7 8B 75 D8                        	MOV	ESI,DWORD [-40+EBP]
   308 000002DA 01 C3                           	ADD	EBX,EAX
   309 000002DC 41                              	INC	ECX
   310 000002DD 8A 45 DF                        	MOV	AL,BYTE [-33+EBP]
   311 000002E0 88 04 33                        	MOV	BYTE [EBX+ESI*1],AL
   312 000002E3 3B 4D E8                        	CMP	ECX,DWORD [-24+EBP]
   313 000002E6 7C E0                           	JL	L59
   314 000002E8                                 L81:
   315 000002E8 42                              	INC	EDX
   316 000002E9 3B 55 E4                        	CMP	EDX,DWORD [-28+EBP]
   317 000002EC 7C CA                           	JL	L60
   318 000002EE E9 FFFFFF1C                     	JMP	L32
   319 000002F3                                 L88:
   320 000002F3 31 C9                           	XOR	ECX,ECX
   321 000002F5 E9 FFFFFEA2                     	JMP	L35
   322 000002FA                                 L87:
   323 000002FA C7 45 EC 00000000               	MOV	DWORD [-20+EBP],0
   324 00000301 E9 FFFFFE8E                     	JMP	L34
   325 00000306                                 L86:
   326 00000306 C7 45 10 00000000               	MOV	DWORD [16+EBP],0
   327 0000030D E9 FFFFFE07                     	JMP	L27
   328 00000312                                 L85:
   329 00000312 C7 45 0C 00000000               	MOV	DWORD [12+EBP],0
   330 00000319 E9 FFFFFDF1                     	JMP	L26
   331 0000031E                                 	GLOBAL	_sheet_refreshsub
   332 0000031E                                 _sheet_refreshsub:
   333 0000031E 55                              	PUSH	EBP
   334 0000031F 89 E5                           	MOV	EBP,ESP
   335 00000321 57                              	PUSH	EDI
   336 00000322 56                              	PUSH	ESI
   337 00000323 53                              	PUSH	EBX
   338 00000324 83 EC 54                        	SUB	ESP,84
   339 00000327 8B 45 08                        	MOV	EAX,DWORD [8+EBP]
   340 0000032A 8B 55 08                        	MOV	EDX,DWORD [8+EBP]
   341 0000032D 83 7D 0C 00                     	CMP	DWORD [12+EBP],0
   342 00000331 8B 00                           	MOV	EAX,DWORD [EAX]
   343 00000333 8B 52 04                        	MOV	EDX,DWORD [4+EDX]
   344 00000336 89 45 D0                        	MOV	DWORD [-48+EBP],EAX
   345 00000339 89 55 CC                        	MOV	DWORD [-52+EBP],EDX
   346 0000033C 0F 88 000003AD                  	JS	L171
   347 00000342                                 L91:
   348 00000342 83 7D 10 00                     	CMP	DWORD [16+EBP],0
   349 00000346 0F 88 00000397                  	JS	L172
   350 0000034C                                 L92:
   351 0000034C 8B 5D 08                        	MOV	EBX,DWORD [8+EBP]
   352 0000034F 8B 43 08                        	MOV	EAX,DWORD [8+EBX]
   353 00000352 39 45 14                        	CMP	DWORD [20+EBP],EAX
   354 00000355 7E 03                           	JLE	L93
   355 00000357 89 45 14                        	MOV	DWORD [20+EBP],EAX
   356 0000035A                                 L93:
   357 0000035A 8B 55 08                        	MOV	EDX,DWORD [8+EBP]
   358 0000035D 8B 42 0C                        	MOV	EAX,DWORD [12+EDX]
   359 00000360 39 45 18                        	CMP	DWORD [24+EBP],EAX
   360 00000363 7E 03                           	JLE	L94
   361 00000365 89 45 18                        	MOV	DWORD [24+EBP],EAX
   362 00000368                                 L94:
   363 00000368 8B 5D 1C                        	MOV	EBX,DWORD [28+EBP]
   364 0000036B 8B 45 20                        	MOV	EAX,DWORD [32+EBP]
   365 0000036E 89 5D F0                        	MOV	DWORD [-16+EBP],EBX
   366 00000371 39 C3                           	CMP	EBX,EAX
   367 00000373 0F 8F 000001F6                  	JG	L158
   368 00000379                                 L156:
   369 00000379 8B 5D 08                        	MOV	EBX,DWORD [8+EBP]
   370 0000037C 8B 55 F0                        	MOV	EDX,DWORD [-16+EBP]
   371 0000037F 8B 4D 10                        	MOV	ECX,DWORD [16+EBP]
   372 00000382 8B 7C 93 14                     	MOV	EDI,DWORD [20+EBX+EDX*4]
   373 00000386 8B 07                           	MOV	EAX,DWORD [EDI]
   374 00000388 8B 57 0C                        	MOV	EDX,DWORD [12+EDI]
   375 0000038B 89 45 C4                        	MOV	DWORD [-60+EBP],EAX
   376 0000038E 89 55 B8                        	MOV	DWORD [-72+EBP],EDX
   377 00000391 89 F8                           	MOV	EAX,EDI
   378 00000393 29 D8                           	SUB	EAX,EBX
   379 00000395 8B 5F 10                        	MOV	EBX,DWORD [16+EDI]
   380 00000398 2D 00000414                     	SUB	EAX,1044
   381 0000039D 29 D9                           	SUB	ECX,EBX
   382 0000039F C1 F8 02                        	SAR	EAX,2
   383 000003A2 89 5D B4                        	MOV	DWORD [-76+EBP],EBX
   384 000003A5 69 C0 BA2E8BA3                  	IMUL	EAX,EAX,-1171354717
   385 000003AB 88 45 CB                        	MOV	BYTE [-53+EBP],AL
   386 000003AE 8B 45 14                        	MOV	EAX,DWORD [20+EBP]
   387 000003B1 29 D0                           	SUB	EAX,EDX
   388 000003B3 8B 55 18                        	MOV	EDX,DWORD [24+EBP]
   389 000003B6 29 DA                           	SUB	EDX,EBX
   390 000003B8 89 45 E4                        	MOV	DWORD [-28+EBP],EAX
   391 000003BB 8B 5D 0C                        	MOV	EBX,DWORD [12+EBP]
   392 000003BE 89 55 E0                        	MOV	DWORD [-32+EBP],EDX
   393 000003C1 2B 5D B8                        	SUB	EBX,DWORD [-72+EBP]
   394 000003C4 89 5D E8                        	MOV	DWORD [-24+EBP],EBX
   395 000003C7 0F 88 0000030A                  	JS	L173
   396 000003CD                                 L99:
   397 000003CD 85 C9                           	TEST	ECX,ECX
   398 000003CF 0F 88 000002FB                  	JS	L174
   399 000003D5                                 L100:
   400 000003D5 8B 47 04                        	MOV	EAX,DWORD [4+EDI]
   401 000003D8 89 45 B0                        	MOV	DWORD [-80+EBP],EAX
   402 000003DB 39 45 E4                        	CMP	DWORD [-28+EBP],EAX
   403 000003DE 7E 03                           	JLE	L101
   404 000003E0 89 45 E4                        	MOV	DWORD [-28+EBP],EAX
   405 000003E3                                 L101:
   406 000003E3 8B 47 08                        	MOV	EAX,DWORD [8+EDI]
   407 000003E6 39 45 E0                        	CMP	DWORD [-32+EBP],EAX
   408 000003E9 7E 03                           	JLE	L102
   409 000003EB 89 45 E0                        	MOV	DWORD [-32+EBP],EAX
   410 000003EE                                 L102:
   411 000003EE 80 3D 000005F2 08               	CMP	BYTE [1522],8
   412 000003F5 0F 84 00000276                  	JE	L175
   413 000003FB F7 45 B8 00000002               	TEST	DWORD [-72+EBP],2
   414 00000402 0F 85 000001F3                  	JNE	L116
   415 00000408 8B 55 E8                        	MOV	EDX,DWORD [-24+EBP]
   416 0000040B BE 00000002                     	MOV	ESI,2
   417 00000410 42                              	INC	EDX
   418 00000411 89 D0                           	MOV	EAX,EDX
   419 00000413 99                              	CDQ
   420 00000414 F7 FE                           	IDIV	ESI
   421 00000416 89 45 A0                        	MOV	DWORD [-96+EBP],EAX
   422 00000419 8B 45 E4                        	MOV	EAX,DWORD [-28+EBP]
   423 0000041C 99                              	CDQ
   424 0000041D F7 FE                           	IDIV	ESI
   425 0000041F 8B 55 A0                        	MOV	EDX,DWORD [-96+EBP]
   426 00000422 89 CE                           	MOV	ESI,ECX
   427 00000424 29 D0                           	SUB	EAX,EDX
   428 00000426 89 45 DC                        	MOV	DWORD [-36+EBP],EAX
   429 00000429 66 0F B6 5D CB                  	MOVZX	BX,BYTE [-53+EBP]
   430 0000042E 0F B6 45 CB                     	MOVZX	EAX,BYTE [-53+EBP]
   431 00000432 C1 E0 08                        	SAL	EAX,8
   432 00000435 66 89 5D C2                     	MOV	WORD [-62+EBP],BX
   433 00000439 66 09 45 C2                     	OR	WORD [-62+EBP],AX
   434 0000043D 3B 4D E0                        	CMP	ECX,DWORD [-32+EBP]
   435 00000440 0F 8D 0000011A                  	JGE	L97
   436 00000446                                 L143:
   437 00000446 8B 47 10                        	MOV	EAX,DWORD [16+EDI]
   438 00000449 8B 4D E8                        	MOV	ECX,DWORD [-24+EBP]
   439 0000044C 01 F0                           	ADD	EAX,ESI
   440 0000044E 3B 4D E4                        	CMP	ECX,DWORD [-28+EBP]
   441 00000451 89 45 EC                        	MOV	DWORD [-20+EBP],EAX
   442 00000454 7D 37                           	JGE	L122
   443 00000456 F7 C1 00000001                  	TEST	ECX,1
   444 0000045C 74 2F                           	JE	L122
   445 0000045E                                 L127:
   446 0000045E 8B 5D 08                        	MOV	EBX,DWORD [8+EBP]
   447 00000461 8B 45 EC                        	MOV	EAX,DWORD [-20+EBP]
   448 00000464 8B 57 0C                        	MOV	EDX,DWORD [12+EDI]
   449 00000467 0F AF 43 08                     	IMUL	EAX,DWORD [8+EBX]
   450 0000046B 01 CA                           	ADD	EDX,ECX
   451 0000046D 8B 5D CC                        	MOV	EBX,DWORD [-52+EBP]
   452 00000470 8D 14 02                        	LEA	EDX,DWORD [EDX+EAX*1]
   453 00000473 8A 45 CB                        	MOV	AL,BYTE [-53+EBP]
   454 00000476 38 04 1A                        	CMP	BYTE [EDX+EBX*1],AL
   455 00000479 0F 84 00000161                  	JE	L176
   456 0000047F                                 L123:
   457 0000047F 41                              	INC	ECX
   458 00000480 3B 4D E4                        	CMP	ECX,DWORD [-28+EBP]
   459 00000483 7D 08                           	JGE	L122
   460 00000485 F7 C1 00000001                  	TEST	ECX,1
   461 0000048B 75 D1                           	JNE	L127
   462 0000048D                                 L122:
   463 0000048D 8B 5D 08                        	MOV	EBX,DWORD [8+EBP]
   464 00000490 8B 45 EC                        	MOV	EAX,DWORD [-20+EBP]
   465 00000493 8B 57 0C                        	MOV	EDX,DWORD [12+EDI]
   466 00000496 0F AF 43 08                     	IMUL	EAX,DWORD [8+EBX]
   467 0000049A 01 CA                           	ADD	EDX,ECX
   468 0000049C 8B 5D D0                        	MOV	EBX,DWORD [-48+EBP]
   469 0000049F 01 D0                           	ADD	EAX,EDX
   470 000004A1 8B 55 CC                        	MOV	EDX,DWORD [-52+EBP]
   471 000004A4 01 C2                           	ADD	EDX,EAX
   472 000004A6 8D 04 43                        	LEA	EAX,DWORD [EBX+EAX*2]
   473 000004A9 89 55 BC                        	MOV	DWORD [-68+EBP],EDX
   474 000004AC 89 45 D8                        	MOV	DWORD [-40+EBP],EAX
   475 000004AF 8B 55 C4                        	MOV	EDX,DWORD [-60+EBP]
   476 000004B2 89 F0                           	MOV	EAX,ESI
   477 000004B4 8B 5D DC                        	MOV	EBX,DWORD [-36+EBP]
   478 000004B7 0F AF 47 04                     	IMUL	EAX,DWORD [4+EDI]
   479 000004BB 01 C8                           	ADD	EAX,ECX
   480 000004BD C7 45 A0 00000000               	MOV	DWORD [-96+EBP],0
   481 000004C4 8D 04 42                        	LEA	EAX,DWORD [EDX+EAX*2]
   482 000004C7 39 5D A0                        	CMP	DWORD [-96+EBP],EBX
   483 000004CA 89 45 D4                        	MOV	DWORD [-44+EBP],EAX
   484 000004CD 7D 59                           	JGE	L165
   485 000004CF 89 4D AC                        	MOV	DWORD [-84+EBP],ECX
   486 000004D2                                 L136:
   487 000004D2 66 8B 5D C2                     	MOV	BX,WORD [-62+EBP]
   488 000004D6 8B 45 A0                        	MOV	EAX,DWORD [-96+EBP]
   489 000004D9 8B 55 BC                        	MOV	EDX,DWORD [-68+EBP]
   490 000004DC 66 39 1C 42                     	CMP	WORD [EDX+EAX*2],BX
   491 000004E0 0F 84 000000E6                  	JE	L177
   492 000004E6 8B 5D 08                        	MOV	EBX,DWORD [8+EBP]
   493 000004E9 8B 45 EC                        	MOV	EAX,DWORD [-20+EBP]
   494 000004EC 8B 55 AC                        	MOV	EDX,DWORD [-84+EBP]
   495 000004EF 0F AF 43 08                     	IMUL	EAX,DWORD [8+EBX]
   496 000004F3 03 57 0C                        	ADD	EDX,DWORD [12+EDI]
   497 000004F6 8A 5D CB                        	MOV	BL,BYTE [-53+EBP]
   498 000004F9 01 C2                           	ADD	EDX,EAX
   499 000004FB 8B 45 CC                        	MOV	EAX,DWORD [-52+EBP]
   500 000004FE 89 55 A4                        	MOV	DWORD [-92+EBP],EDX
   501 00000501 38 1C 02                        	CMP	BYTE [EDX+EAX*1],BL
   502 00000504 0F 84 000000A3                  	JE	L178
   503 0000050A                                 L134:
   504 0000050A 8B 45 CC                        	MOV	EAX,DWORD [-52+EBP]
   505 0000050D 8B 55 A4                        	MOV	EDX,DWORD [-92+EBP]
   506 00000510 8A 5D CB                        	MOV	BL,BYTE [-53+EBP]
   507 00000513 38 5C 02 01                     	CMP	BYTE [1+EDX+EAX*1],BL
   508 00000517 74 76                           	JE	L179
   509 00000519                                 L130:
   510 00000519 8B 45 DC                        	MOV	EAX,DWORD [-36+EBP]
   511 0000051C FF 45 A0                        	INC	DWORD [-96+EBP]
   512 0000051F 83 45 AC 02                     	ADD	DWORD [-84+EBP],2
   513 00000523 39 45 A0                        	CMP	DWORD [-96+EBP],EAX
   514 00000526 7C AA                           	JL	L136
   515 00000528                                 L165:
   516 00000528 8B 55 DC                        	MOV	EDX,DWORD [-36+EBP]
   517 0000052B 8D 0C 51                        	LEA	ECX,DWORD [ECX+EDX*2]
   518 0000052E 3B 4D E4                        	CMP	ECX,DWORD [-28+EBP]
   519 00000531 7D 23                           	JGE	L167
   520 00000533                                 L142:
   521 00000533 8B 5D 08                        	MOV	EBX,DWORD [8+EBP]
   522 00000536 8B 45 EC                        	MOV	EAX,DWORD [-20+EBP]
   523 00000539 8B 57 0C                        	MOV	EDX,DWORD [12+EDI]
   524 0000053C 0F AF 43 08                     	IMUL	EAX,DWORD [8+EBX]
   525 00000540 01 CA                           	ADD	EDX,ECX
   526 00000542 8B 5D CC                        	MOV	EBX,DWORD [-52+EBP]
   527 00000545 8D 14 02                        	LEA	EDX,DWORD [EDX+EAX*1]
   528 00000548 8A 45 CB                        	MOV	AL,BYTE [-53+EBP]
   529 0000054B 38 04 1A                        	CMP	BYTE [EDX+EBX*1],AL
   530 0000054E 74 27                           	JE	L180
   531 00000550                                 L139:
   532 00000550 41                              	INC	ECX
   533 00000551 3B 4D E4                        	CMP	ECX,DWORD [-28+EBP]
   534 00000554 7C DD                           	JL	L142
   535 00000556                                 L167:
   536 00000556 46                              	INC	ESI
   537 00000557 3B 75 E0                        	CMP	ESI,DWORD [-32+EBP]
   538 0000055A 0F 8C FFFFFEE6                  	JL	L143
   539 00000560                                 L97:
   540 00000560 8B 5D 20                        	MOV	EBX,DWORD [32+EBP]
   541 00000563 FF 45 F0                        	INC	DWORD [-16+EBP]
   542 00000566 39 5D F0                        	CMP	DWORD [-16+EBP],EBX
   543 00000569 0F 8E FFFFFE0A                  	JLE	L156
   544 0000056F                                 L158:
   545 0000056F 83 C4 54                        	ADD	ESP,84
   546 00000572 5B                              	POP	EBX
   547 00000573 5E                              	POP	ESI
   548 00000574 5F                              	POP	EDI
   549 00000575 5D                              	POP	EBP
   550 00000576 C3                              	RET
   551 00000577                                 L180:
   552 00000577 89 F0                           	MOV	EAX,ESI
   553 00000579 8B 5D C4                        	MOV	EBX,DWORD [-60+EBP]
   554 0000057C 0F AF 47 04                     	IMUL	EAX,DWORD [4+EDI]
   555 00000580 01 C8                           	ADD	EAX,ECX
   556 00000582 66 8B 04 43                     	MOV	AX,WORD [EBX+EAX*2]
   557 00000586 8B 5D D0                        	MOV	EBX,DWORD [-48+EBP]
   558 00000589 66 89 04 53                     	MOV	WORD [EBX+EDX*2],AX
   559 0000058D EB C1                           	JMP	L139
   560 0000058F                                 L179:
   561 0000058F 89 F0                           	MOV	EAX,ESI
   562 00000591 8B 5D C4                        	MOV	EBX,DWORD [-60+EBP]
   563 00000594 0F AF 47 04                     	IMUL	EAX,DWORD [4+EDI]
   564 00000598 03 45 AC                        	ADD	EAX,DWORD [-84+EBP]
   565 0000059B 66 8B 44 43 02                  	MOV	AX,WORD [2+EBX+EAX*2]
   566 000005A0 8B 5D D0                        	MOV	EBX,DWORD [-48+EBP]
   567 000005A3 66 89 44 53 02                  	MOV	WORD [2+EBX+EDX*2],AX
   568 000005A8 E9 FFFFFF6C                     	JMP	L130
   569 000005AD                                 L178:
   570 000005AD 89 F0                           	MOV	EAX,ESI
   571 000005AF 8B 55 C4                        	MOV	EDX,DWORD [-60+EBP]
   572 000005B2 0F AF 47 04                     	IMUL	EAX,DWORD [4+EDI]
   573 000005B6 03 45 AC                        	ADD	EAX,DWORD [-84+EBP]
   574 000005B9 8B 5D A4                        	MOV	EBX,DWORD [-92+EBP]
   575 000005BC 66 8B 04 42                     	MOV	AX,WORD [EDX+EAX*2]
   576 000005C0 8B 55 D0                        	MOV	EDX,DWORD [-48+EBP]
   577 000005C3 66 89 04 5A                     	MOV	WORD [EDX+EBX*2],AX
   578 000005C7 E9 FFFFFF3E                     	JMP	L134
   579 000005CC                                 L177:
   580 000005CC 8B 55 D4                        	MOV	EDX,DWORD [-44+EBP]
   581 000005CF 8B 5D A0                        	MOV	EBX,DWORD [-96+EBP]
   582 000005D2 8B 04 82                        	MOV	EAX,DWORD [EDX+EAX*4]
   583 000005D5 8B 55 D8                        	MOV	EDX,DWORD [-40+EBP]
   584 000005D8 89 04 9A                        	MOV	DWORD [EDX+EBX*4],EAX
   585 000005DB E9 FFFFFF39                     	JMP	L130
   586 000005E0                                 L176:
   587 000005E0 89 F0                           	MOV	EAX,ESI
   588 000005E2 8B 5D C4                        	MOV	EBX,DWORD [-60+EBP]
   589 000005E5 0F AF 47 04                     	IMUL	EAX,DWORD [4+EDI]
   590 000005E9 01 C8                           	ADD	EAX,ECX
   591 000005EB 66 8B 04 43                     	MOV	AX,WORD [EBX+EAX*2]
   592 000005EF 8B 5D D0                        	MOV	EBX,DWORD [-48+EBP]
   593 000005F2 66 89 04 53                     	MOV	WORD [EBX+EDX*2],AX
   594 000005F6 E9 FFFFFE84                     	JMP	L123
   595 000005FB                                 L116:
   596 000005FB 89 CE                           	MOV	ESI,ECX
   597 000005FD 3B 4D E0                        	CMP	ECX,DWORD [-32+EBP]
   598 00000600 0F 8D FFFFFF5A                  	JGE	L97
   599 00000606 8B 7D B0                        	MOV	EDI,DWORD [-80+EBP]
   600 00000609 0F AF F9                        	IMUL	EDI,ECX
   601 0000060C                                 L155:
   602 0000060C 8B 45 B4                        	MOV	EAX,DWORD [-76+EBP]
   603 0000060F 8B 4D E8                        	MOV	ECX,DWORD [-24+EBP]
   604 00000612 01 F0                           	ADD	EAX,ESI
   605 00000614 3B 4D E4                        	CMP	ECX,DWORD [-28+EBP]
   606 00000617 89 45 EC                        	MOV	DWORD [-20+EBP],EAX
   607 0000061A 7D 35                           	JGE	L170
   608 0000061C 8D 04 39                        	LEA	EAX,DWORD [ECX+EDI*1]
   609 0000061F 8B 55 C4                        	MOV	EDX,DWORD [-60+EBP]
   610 00000622 8D 04 42                        	LEA	EAX,DWORD [EDX+EAX*2]
   611 00000625 89 45 A0                        	MOV	DWORD [-96+EBP],EAX
   612 00000628                                 L154:
   613 00000628 8B 5D 08                        	MOV	EBX,DWORD [8+EBP]
   614 0000062B 8B 45 EC                        	MOV	EAX,DWORD [-20+EBP]
   615 0000062E 8B 55 B8                        	MOV	EDX,DWORD [-72+EBP]
   616 00000631 0F AF 43 08                     	IMUL	EAX,DWORD [8+EBX]
   617 00000635 01 CA                           	ADD	EDX,ECX
   618 00000637 8A 5D CB                        	MOV	BL,BYTE [-53+EBP]
   619 0000063A 01 C2                           	ADD	EDX,EAX
   620 0000063C 8B 45 CC                        	MOV	EAX,DWORD [-52+EBP]
   621 0000063F 89 55 A4                        	MOV	DWORD [-92+EBP],EDX
   622 00000642 38 1C 02                        	CMP	BYTE [EDX+EAX*1],BL
   623 00000645 74 18                           	JE	L181
   624 00000647                                 L151:
   625 00000647 41                              	INC	ECX
   626 00000648 83 45 A0 02                     	ADD	DWORD [-96+EBP],2
   627 0000064C 3B 4D E4                        	CMP	ECX,DWORD [-28+EBP]
   628 0000064F 7C D7                           	JL	L154
   629 00000651                                 L170:
   630 00000651 46                              	INC	ESI
   631 00000652 03 7D B0                        	ADD	EDI,DWORD [-80+EBP]
   632 00000655 3B 75 E0                        	CMP	ESI,DWORD [-32+EBP]
   633 00000658 7C B2                           	JL	L155
   634 0000065A E9 FFFFFF01                     	JMP	L97
   635 0000065F                                 L181:
   636 0000065F 8B 55 A0                        	MOV	EDX,DWORD [-96+EBP]
   637 00000662 8B 5D A4                        	MOV	EBX,DWORD [-92+EBP]
   638 00000665 66 8B 02                        	MOV	AX,WORD [EDX]
   639 00000668 8B 55 D0                        	MOV	EDX,DWORD [-48+EBP]
   640 0000066B 66 89 04 5A                     	MOV	WORD [EDX+EBX*2],AX
   641 0000066F EB D6                           	JMP	L151
   642 00000671                                 L175:
   643 00000671 89 CE                           	MOV	ESI,ECX
   644 00000673 3B 4D E0                        	CMP	ECX,DWORD [-32+EBP]
   645 00000676 0F 8D FFFFFEE4                  	JGE	L97
   646 0000067C                                 L114:
   647 0000067C 8B 57 10                        	MOV	EDX,DWORD [16+EDI]
   648 0000067F 8B 4D E8                        	MOV	ECX,DWORD [-24+EBP]
   649 00000682 01 F2                           	ADD	EDX,ESI
   650 00000684 3B 4D E4                        	CMP	ECX,DWORD [-28+EBP]
   651 00000687 89 55 EC                        	MOV	DWORD [-20+EBP],EDX
   652 0000068A 7D 23                           	JGE	L161
   653 0000068C                                 L113:
   654 0000068C 8B 5D 08                        	MOV	EBX,DWORD [8+EBP]
   655 0000068F 8B 45 EC                        	MOV	EAX,DWORD [-20+EBP]
   656 00000692 8B 57 0C                        	MOV	EDX,DWORD [12+EDI]
   657 00000695 0F AF 43 08                     	IMUL	EAX,DWORD [8+EBX]
   658 00000699 01 CA                           	ADD	EDX,ECX
   659 0000069B 8B 5D CC                        	MOV	EBX,DWORD [-52+EBP]
   660 0000069E 8D 14 02                        	LEA	EDX,DWORD [EDX+EAX*1]
   661 000006A1 8A 45 CB                        	MOV	AL,BYTE [-53+EBP]
   662 000006A4 38 04 1A                        	CMP	BYTE [EDX+EBX*1],AL
   663 000006A7 74 11                           	JE	L182
   664 000006A9                                 L110:
   665 000006A9 41                              	INC	ECX
   666 000006AA 3B 4D E4                        	CMP	ECX,DWORD [-28+EBP]
   667 000006AD 7C DD                           	JL	L113
   668 000006AF                                 L161:
   669 000006AF 46                              	INC	ESI
   670 000006B0 3B 75 E0                        	CMP	ESI,DWORD [-32+EBP]
   671 000006B3 7C C7                           	JL	L114
   672 000006B5 E9 FFFFFEA6                     	JMP	L97
   673 000006BA                                 L182:
   674 000006BA 89 F0                           	MOV	EAX,ESI
   675 000006BC 8B 5D C4                        	MOV	EBX,DWORD [-60+EBP]
   676 000006BF 0F AF 47 04                     	IMUL	EAX,DWORD [4+EDI]
   677 000006C3 01 C8                           	ADD	EAX,ECX
   678 000006C5 8A 04 43                        	MOV	AL,BYTE [EBX+EAX*2]
   679 000006C8 8B 5D D0                        	MOV	EBX,DWORD [-48+EBP]
   680 000006CB 88 04 1A                        	MOV	BYTE [EDX+EBX*1],AL
   681 000006CE EB D9                           	JMP	L110
   682 000006D0                                 L174:
   683 000006D0 31 C9                           	XOR	ECX,ECX
   684 000006D2 E9 FFFFFCFE                     	JMP	L100
   685 000006D7                                 L173:
   686 000006D7 C7 45 E8 00000000               	MOV	DWORD [-24+EBP],0
   687 000006DE E9 FFFFFCEA                     	JMP	L99
   688 000006E3                                 L172:
   689 000006E3 C7 45 10 00000000               	MOV	DWORD [16+EBP],0
   690 000006EA E9 FFFFFC5D                     	JMP	L92
   691 000006EF                                 L171:
   692 000006EF C7 45 0C 00000000               	MOV	DWORD [12+EBP],0
   693 000006F6 E9 FFFFFC47                     	JMP	L91
   694 000006FB                                 	GLOBAL	_sheet_updown
   695 000006FB                                 _sheet_updown:
   696 000006FB 55                              	PUSH	EBP
   697 000006FC 89 E5                           	MOV	EBP,ESP
   698 000006FE 57                              	PUSH	EDI
   699 000006FF 56                              	PUSH	ESI
   700 00000700 53                              	PUSH	EBX
   701 00000701 51                              	PUSH	ECX
   702 00000702 8B 7D 08                        	MOV	EDI,DWORD [8+EBP]
   703 00000705 8B 5D 0C                        	MOV	EBX,DWORD [12+EBP]
   704 00000708 8B 77 20                        	MOV	ESI,DWORD [32+EDI]
   705 0000070B 8B 47 18                        	MOV	EAX,DWORD [24+EDI]
   706 0000070E 89 45 F0                        	MOV	DWORD [-16+EBP],EAX
   707 00000711 8B 46 10                        	MOV	EAX,DWORD [16+ESI]
   708 00000714 40                              	INC	EAX
   709 00000715 39 C3                           	CMP	EBX,EAX
   710 00000717 7E 02                           	JLE	L184
   711 00000719 89 C3                           	MOV	EBX,EAX
   712 0000071B                                 L184:
   713 0000071B 83 FB FF                        	CMP	EBX,-1
   714 0000071E 7D 03                           	JGE	L185
   715 00000720 83 CB FF                        	OR	EBX,-1
   716 00000723                                 L185:
   717 00000723 89 5F 18                        	MOV	DWORD [24+EDI],EBX
   718 00000726 39 5D F0                        	CMP	DWORD [-16+EBP],EBX
   719 00000729 0F 8E 000000A8                  	JLE	L186
   720 0000072F 85 DB                           	TEST	EBX,EBX
   721 00000731 78 5C                           	JS	L187
   722 00000733 8B 4D F0                        	MOV	ECX,DWORD [-16+EBP]
   723 00000736                                 L192:
   724 00000736 8B 44 8E 10                     	MOV	EAX,DWORD [16+ESI+ECX*4]
   725 0000073A 89 44 8E 14                     	MOV	DWORD [20+ESI+ECX*4],EAX
   726 0000073E 89 48 18                        	MOV	DWORD [24+EAX],ECX
   727 00000741 49                              	DEC	ECX
   728 00000742 39 D9                           	CMP	ECX,EBX
   729 00000744 7F F0                           	JG	L192
   730 00000746 89 7C 9E 14                     	MOV	DWORD [20+ESI+EBX*4],EDI
   731 0000074A 43                              	INC	EBX
   732 0000074B 53                              	PUSH	EBX
   733 0000074C 8B 4F 10                        	MOV	ECX,DWORD [16+EDI]
   734 0000074F 89 C8                           	MOV	EAX,ECX
   735 00000751 03 47 08                        	ADD	EAX,DWORD [8+EDI]
   736 00000754 50                              	PUSH	EAX
   737 00000755 8B 57 0C                        	MOV	EDX,DWORD [12+EDI]
   738 00000758 89 D0                           	MOV	EAX,EDX
   739 0000075A 03 47 04                        	ADD	EAX,DWORD [4+EDI]
   740 0000075D 50                              	PUSH	EAX
   741 0000075E 51                              	PUSH	ECX
   742 0000075F 52                              	PUSH	EDX
   743 00000760 56                              	PUSH	ESI
   744 00000761 E8 FFFFF98D                     	CALL	_sheet_refreshmap
   745 00000766 FF 75 F0                        	PUSH	DWORD [-16+EBP]
   746 00000769                                 L222:
   747 00000769 53                              	PUSH	EBX
   748 0000076A                                 L221:
   749 0000076A 8B 4F 10                        	MOV	ECX,DWORD [16+EDI]
   750 0000076D 89 C8                           	MOV	EAX,ECX
   751 0000076F 03 47 08                        	ADD	EAX,DWORD [8+EDI]
   752 00000772 50                              	PUSH	EAX
   753 00000773 8B 57 0C                        	MOV	EDX,DWORD [12+EDI]
   754 00000776 89 D0                           	MOV	EAX,EDX
   755 00000778 03 47 04                        	ADD	EAX,DWORD [4+EDI]
   756 0000077B 50                              	PUSH	EAX
   757 0000077C 51                              	PUSH	ECX
   758 0000077D 52                              	PUSH	EDX
   759 0000077E 56                              	PUSH	ESI
   760 0000077F E8 FFFFFB9A                     	CALL	_sheet_refreshsub
   761 00000784 83 C4 34                        	ADD	ESP,52
   762 00000787                                 L183:
   763 00000787 8D 65 F4                        	LEA	ESP,DWORD [-12+EBP]
   764 0000078A 5B                              	POP	EBX
   765 0000078B 5E                              	POP	ESI
   766 0000078C 5F                              	POP	EDI
   767 0000078D 5D                              	POP	EBP
   768 0000078E C3                              	RET
   769 0000078F                                 L187:
   770 0000078F 8B 46 10                        	MOV	EAX,DWORD [16+ESI]
   771 00000792 3B 45 F0                        	CMP	EAX,DWORD [-16+EBP]
   772 00000795 7E 18                           	JLE	L194
   773 00000797 8B 4D F0                        	MOV	ECX,DWORD [-16+EBP]
   774 0000079A 39 C1                           	CMP	ECX,EAX
   775 0000079C 7D 11                           	JGE	L194
   776 0000079E                                 L199:
   777 0000079E 8B 44 8E 18                     	MOV	EAX,DWORD [24+ESI+ECX*4]
   778 000007A2 89 44 8E 14                     	MOV	DWORD [20+ESI+ECX*4],EAX
   779 000007A6 89 48 18                        	MOV	DWORD [24+EAX],ECX
   780 000007A9 41                              	INC	ECX
   781 000007AA 3B 4E 10                        	CMP	ECX,DWORD [16+ESI]
   782 000007AD 7C EF                           	JL	L199
   783 000007AF                                 L194:
   784 000007AF FF 4E 10                        	DEC	DWORD [16+ESI]
   785 000007B2 6A 00                           	PUSH	0
   786 000007B4 8B 4F 10                        	MOV	ECX,DWORD [16+EDI]
   787 000007B7 89 C8                           	MOV	EAX,ECX
   788 000007B9 03 47 08                        	ADD	EAX,DWORD [8+EDI]
   789 000007BC 50                              	PUSH	EAX
   790 000007BD 8B 57 0C                        	MOV	EDX,DWORD [12+EDI]
   791 000007C0 89 D0                           	MOV	EAX,EDX
   792 000007C2 03 47 04                        	ADD	EAX,DWORD [4+EDI]
   793 000007C5 50                              	PUSH	EAX
   794 000007C6 51                              	PUSH	ECX
   795 000007C7 52                              	PUSH	EDX
   796 000007C8 56                              	PUSH	ESI
   797 000007C9 E8 FFFFF925                     	CALL	_sheet_refreshmap
   798 000007CE 8B 45 F0                        	MOV	EAX,DWORD [-16+EBP]
   799 000007D1 48                              	DEC	EAX
   800 000007D2 50                              	PUSH	EAX
   801 000007D3 6A 00                           	PUSH	0
   802 000007D5 EB 93                           	JMP	L221
   803 000007D7                                 L186:
   804 000007D7 39 5D F0                        	CMP	DWORD [-16+EBP],EBX
   805 000007DA 7D AB                           	JGE	L183
   806 000007DC 83 7D F0 00                     	CMP	DWORD [-16+EBP],0
   807 000007E0 78 3C                           	JS	L202
   808 000007E2 8B 4D F0                        	MOV	ECX,DWORD [-16+EBP]
   809 000007E5 39 D9                           	CMP	ECX,EBX
   810 000007E7 7D 10                           	JGE	L218
   811 000007E9                                 L207:
   812 000007E9 8B 44 8E 18                     	MOV	EAX,DWORD [24+ESI+ECX*4]
   813 000007ED 89 44 8E 14                     	MOV	DWORD [20+ESI+ECX*4],EAX
   814 000007F1 89 48 18                        	MOV	DWORD [24+EAX],ECX
   815 000007F4 41                              	INC	ECX
   816 000007F5 39 D9                           	CMP	ECX,EBX
   817 000007F7 7C F0                           	JL	L207
   818 000007F9                                 L218:
   819 000007F9 89 7C 9E 14                     	MOV	DWORD [20+ESI+EBX*4],EDI
   820 000007FD                                 L208:
   821 000007FD 53                              	PUSH	EBX
   822 000007FE 8B 4F 10                        	MOV	ECX,DWORD [16+EDI]
   823 00000801 89 C8                           	MOV	EAX,ECX
   824 00000803 03 47 08                        	ADD	EAX,DWORD [8+EDI]
   825 00000806 50                              	PUSH	EAX
   826 00000807 8B 57 0C                        	MOV	EDX,DWORD [12+EDI]
   827 0000080A 89 D0                           	MOV	EAX,EDX
   828 0000080C 03 47 04                        	ADD	EAX,DWORD [4+EDI]
   829 0000080F 50                              	PUSH	EAX
   830 00000810 51                              	PUSH	ECX
   831 00000811 52                              	PUSH	EDX
   832 00000812 56                              	PUSH	ESI
   833 00000813 E8 FFFFF8DB                     	CALL	_sheet_refreshmap
   834 00000818 53                              	PUSH	EBX
   835 00000819 E9 FFFFFF4B                     	JMP	L222
   836 0000081E                                 L202:
   837 0000081E 8B 4E 10                        	MOV	ECX,DWORD [16+ESI]
   838 00000821 39 D9                           	CMP	ECX,EBX
   839 00000823 7C 13                           	JL	L220
   840 00000825                                 L213:
   841 00000825 8B 54 8E 14                     	MOV	EDX,DWORD [20+ESI+ECX*4]
   842 00000829 8D 41 01                        	LEA	EAX,DWORD [1+ECX]
   843 0000082C 89 54 8E 18                     	MOV	DWORD [24+ESI+ECX*4],EDX
   844 00000830 49                              	DEC	ECX
   845 00000831 89 42 18                        	MOV	DWORD [24+EDX],EAX
   846 00000834 39 D9                           	CMP	ECX,EBX
   847 00000836 7D ED                           	JGE	L213
   848 00000838                                 L220:
   849 00000838 89 7C 9E 14                     	MOV	DWORD [20+ESI+EBX*4],EDI
   850 0000083C FF 46 10                        	INC	DWORD [16+ESI]
   851 0000083F EB BC                           	JMP	L208
   852 00000841                                 	GLOBAL	_sheet_refresh
   853 00000841                                 _sheet_refresh:
   854 00000841 55                              	PUSH	EBP
   855 00000842 89 E5                           	MOV	EBP,ESP
   856 00000844 53                              	PUSH	EBX
   857 00000845 8B 5D 08                        	MOV	EBX,DWORD [8+EBP]
   858 00000848 8B 43 18                        	MOV	EAX,DWORD [24+EBX]
   859 0000084B 85 C0                           	TEST	EAX,EAX
   860 0000084D 78 27                           	JS	L223
   861 0000084F 50                              	PUSH	EAX
   862 00000850 50                              	PUSH	EAX
   863 00000851 8B 4B 10                        	MOV	ECX,DWORD [16+EBX]
   864 00000854 89 C8                           	MOV	EAX,ECX
   865 00000856 03 4D 10                        	ADD	ECX,DWORD [16+EBP]
   866 00000859 03 45 18                        	ADD	EAX,DWORD [24+EBP]
   867 0000085C 50                              	PUSH	EAX
   868 0000085D 8B 53 0C                        	MOV	EDX,DWORD [12+EBX]
   869 00000860 89 D0                           	MOV	EAX,EDX
   870 00000862 03 55 0C                        	ADD	EDX,DWORD [12+EBP]
   871 00000865 03 45 14                        	ADD	EAX,DWORD [20+EBP]
   872 00000868 50                              	PUSH	EAX
   873 00000869 51                              	PUSH	ECX
   874 0000086A 52                              	PUSH	EDX
   875 0000086B FF 73 20                        	PUSH	DWORD [32+EBX]
   876 0000086E E8 FFFFFAAB                     	CALL	_sheet_refreshsub
   877 00000873 83 C4 1C                        	ADD	ESP,28
   878 00000876                                 L223:
   879 00000876 8B 5D FC                        	MOV	EBX,DWORD [-4+EBP]
   880 00000879 C9                              	LEAVE
   881 0000087A C3                              	RET
   882 0000087B                                 	GLOBAL	_sheet_slide
   883 0000087B                                 _sheet_slide:
   884 0000087B 55                              	PUSH	EBP
   885 0000087C 89 E5                           	MOV	EBP,ESP
   886 0000087E 57                              	PUSH	EDI
   887 0000087F 56                              	PUSH	ESI
   888 00000880 53                              	PUSH	EBX
   889 00000881 53                              	PUSH	EBX
   890 00000882 8B 5D 08                        	MOV	EBX,DWORD [8+EBP]
   891 00000885 8B 43 20                        	MOV	EAX,DWORD [32+EBX]
   892 00000888 8B 7B 0C                        	MOV	EDI,DWORD [12+EBX]
   893 0000088B 89 45 F0                        	MOV	DWORD [-16+EBP],EAX
   894 0000088E 8B 73 10                        	MOV	ESI,DWORD [16+EBX]
   895 00000891 8B 45 0C                        	MOV	EAX,DWORD [12+EBP]
   896 00000894 89 43 0C                        	MOV	DWORD [12+EBX],EAX
   897 00000897 8B 45 10                        	MOV	EAX,DWORD [16+EBP]
   898 0000089A 89 43 10                        	MOV	DWORD [16+EBX],EAX
   899 0000089D 83 7B 18 00                     	CMP	DWORD [24+EBX],0
   900 000008A1 78 7C                           	JS	L225
   901 000008A3 6A 00                           	PUSH	0
   902 000008A5 89 F0                           	MOV	EAX,ESI
   903 000008A7 03 43 08                        	ADD	EAX,DWORD [8+EBX]
   904 000008AA 50                              	PUSH	EAX
   905 000008AB 89 F8                           	MOV	EAX,EDI
   906 000008AD 03 43 04                        	ADD	EAX,DWORD [4+EBX]
   907 000008B0 50                              	PUSH	EAX
   908 000008B1 56                              	PUSH	ESI
   909 000008B2 57                              	PUSH	EDI
   910 000008B3 FF 75 F0                        	PUSH	DWORD [-16+EBP]
   911 000008B6 E8 FFFFF838                     	CALL	_sheet_refreshmap
   912 000008BB 8B 45 10                        	MOV	EAX,DWORD [16+EBP]
   913 000008BE FF 73 18                        	PUSH	DWORD [24+EBX]
   914 000008C1 03 43 08                        	ADD	EAX,DWORD [8+EBX]
   915 000008C4 50                              	PUSH	EAX
   916 000008C5 8B 45 0C                        	MOV	EAX,DWORD [12+EBP]
   917 000008C8 03 43 04                        	ADD	EAX,DWORD [4+EBX]
   918 000008CB 50                              	PUSH	EAX
   919 000008CC FF 75 10                        	PUSH	DWORD [16+EBP]
   920 000008CF FF 75 0C                        	PUSH	DWORD [12+EBP]
   921 000008D2 FF 75 F0                        	PUSH	DWORD [-16+EBP]
   922 000008D5 E8 FFFFF819                     	CALL	_sheet_refreshmap
   923 000008DA 8B 43 18                        	MOV	EAX,DWORD [24+EBX]
   924 000008DD 83 C4 30                        	ADD	ESP,48
   925 000008E0 48                              	DEC	EAX
   926 000008E1 50                              	PUSH	EAX
   927 000008E2 89 F0                           	MOV	EAX,ESI
   928 000008E4 6A 00                           	PUSH	0
   929 000008E6 03 43 08                        	ADD	EAX,DWORD [8+EBX]
   930 000008E9 50                              	PUSH	EAX
   931 000008EA 89 F8                           	MOV	EAX,EDI
   932 000008EC 03 43 04                        	ADD	EAX,DWORD [4+EBX]
   933 000008EF 50                              	PUSH	EAX
   934 000008F0 56                              	PUSH	ESI
   935 000008F1 57                              	PUSH	EDI
   936 000008F2 FF 75 F0                        	PUSH	DWORD [-16+EBP]
   937 000008F5 E8 FFFFFA24                     	CALL	_sheet_refreshsub
   938 000008FA 8B 45 10                        	MOV	EAX,DWORD [16+EBP]
   939 000008FD FF 73 18                        	PUSH	DWORD [24+EBX]
   940 00000900 FF 73 18                        	PUSH	DWORD [24+EBX]
   941 00000903 03 43 08                        	ADD	EAX,DWORD [8+EBX]
   942 00000906 50                              	PUSH	EAX
   943 00000907 8B 45 0C                        	MOV	EAX,DWORD [12+EBP]
   944 0000090A 03 43 04                        	ADD	EAX,DWORD [4+EBX]
   945 0000090D 50                              	PUSH	EAX
   946 0000090E FF 75 10                        	PUSH	DWORD [16+EBP]
   947 00000911 FF 75 0C                        	PUSH	DWORD [12+EBP]
   948 00000914 FF 75 F0                        	PUSH	DWORD [-16+EBP]
   949 00000917 E8 FFFFFA02                     	CALL	_sheet_refreshsub
   950 0000091C 83 C4 38                        	ADD	ESP,56
   951 0000091F                                 L225:
   952 0000091F 8D 65 F4                        	LEA	ESP,DWORD [-12+EBP]
   953 00000922 5B                              	POP	EBX
   954 00000923 5E                              	POP	ESI
   955 00000924 5F                              	POP	EDI
   956 00000925 5D                              	POP	EBP
   957 00000926 C3                              	RET
   958 00000927                                 	GLOBAL	_sheet_free
   959 00000927                                 _sheet_free:
   960 00000927 55                              	PUSH	EBP
   961 00000928 89 E5                           	MOV	EBP,ESP
   962 0000092A 53                              	PUSH	EBX
   963 0000092B 8B 5D 08                        	MOV	EBX,DWORD [8+EBP]
   964 0000092E 83 7B 18 00                     	CMP	DWORD [24+EBX],0
   965 00000932 78 0A                           	JS	L228
   966 00000934 6A FF                           	PUSH	-1
   967 00000936 53                              	PUSH	EBX
   968 00000937 E8 FFFFFDBF                     	CALL	_sheet_updown
   969 0000093C 58                              	POP	EAX
   970 0000093D 5A                              	POP	EDX
   971 0000093E                                 L228:
   972 0000093E C7 43 1C 00000000               	MOV	DWORD [28+EBX],0
   973 00000945 8B 5D FC                        	MOV	EBX,DWORD [-4+EBP]
   974 00000948 C9                              	LEAVE
   975 00000949 C3                              	RET
