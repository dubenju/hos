     1 00000000                                 [FORMAT "WCOFF"]
     2 00000000                                 [INSTRSET "i486p"]
     3 00000000                                 [OPTIMIZE 1]
     4 00000000                                 [OPTION 1]
     5 00000000                                 [BITS 32]
     6 00000000                                 	EXTERN	_memman_alloc_4k
     7 00000000                                 	EXTERN	_memman_free_4k
     8 00000000                                 	EXTERN	_table_8_565
     9 00000000                                 [FILE "sheet.c"]
    10                                          [SECTION .text]
    11 00000000                                 	GLOBAL	_shtctl_init
    12 00000000                                 _shtctl_init:
    13 00000000 55                              	PUSH	EBP
    14 00000001 89 E5                           	MOV	EBP,ESP
    15 00000003 57                              	PUSH	EDI
    16 00000004 56                              	PUSH	ESI
    17 00000005 53                              	PUSH	EBX
    18 00000006 8B 75 08                        	MOV	ESI,DWORD [8+EBP]
    19 00000009 68 00003014                     	PUSH	12308
    20 0000000E 8B 7D 10                        	MOV	EDI,DWORD [16+EBP]
    21 00000011 56                              	PUSH	ESI
    22 00000012 E8 [00000000]                   	CALL	_memman_alloc_4k
    23 00000017 89 C3                           	MOV	EBX,EAX
    24 00000019 58                              	POP	EAX
    25 0000001A 5A                              	POP	EDX
    26 0000001B 85 DB                           	TEST	EBX,EBX
    27 0000001D 74 4A                           	JE	L3
    28 0000001F 8B 45 14                        	MOV	EAX,DWORD [20+EBP]
    29 00000022 0F AF C7                        	IMUL	EAX,EDI
    30 00000025 50                              	PUSH	EAX
    31 00000026 56                              	PUSH	ESI
    32 00000027 E8 [00000000]                   	CALL	_memman_alloc_4k
    33 0000002C 85 C0                           	TEST	EAX,EAX
    34 0000002E 89 43 04                        	MOV	DWORD [4+EBX],EAX
    35 00000031 5A                              	POP	EDX
    36 00000032 59                              	POP	ECX
    37 00000033 74 3E                           	JE	L11
    38 00000035 8B 45 0C                        	MOV	EAX,DWORD [12+EBP]
    39 00000038 89 7B 08                        	MOV	DWORD [8+EBX],EDI
    40 0000003B 89 03                           	MOV	DWORD [EBX],EAX
    41 0000003D 8D 93 00002BD4                  	LEA	EDX,DWORD [11220+EBX]
    42 00000043 8B 45 14                        	MOV	EAX,DWORD [20+EBP]
    43 00000046 89 43 0C                        	MOV	DWORD [12+EBX],EAX
    44 00000049 89 D8                           	MOV	EAX,EBX
    45 0000004B C7 43 10 FFFFFFFF               	MOV	DWORD [16+EBX],-1
    46 00000052                                 L9:
    47 00000052 C7 80 00000430 00000000         	MOV	DWORD [1072+EAX],0
    48 0000005C 89 98 00000434                  	MOV	DWORD [1076+EAX],EBX
    49 00000062 83 C0 2C                        	ADD	EAX,44
    50 00000065 39 D0                           	CMP	EAX,EDX
    51 00000067 7E E9                           	JLE	L9
    52 00000069                                 L3:
    53 00000069 8D 65 F4                        	LEA	ESP,DWORD [-12+EBP]
    54 0000006C 89 D8                           	MOV	EAX,EBX
    55 0000006E 5B                              	POP	EBX
    56 0000006F 5E                              	POP	ESI
    57 00000070 5F                              	POP	EDI
    58 00000071 5D                              	POP	EBP
    59 00000072 C3                              	RET
    60 00000073                                 L11:
    61 00000073 68 00003014                     	PUSH	12308
    62 00000078 53                              	PUSH	EBX
    63 00000079 31 DB                           	XOR	EBX,EBX
    64 0000007B 56                              	PUSH	ESI
    65 0000007C E8 [00000000]                   	CALL	_memman_free_4k
    66 00000081 83 C4 0C                        	ADD	ESP,12
    67 00000084 EB E3                           	JMP	L3
    68 00000086                                 	GLOBAL	_sheet_alloc
    69 00000086                                 _sheet_alloc:
    70 00000086 55                              	PUSH	EBP
    71 00000087 31 D2                           	XOR	EDX,EDX
    72 00000089 89 E5                           	MOV	EBP,ESP
    73 0000008B 8B 45 08                        	MOV	EAX,DWORD [8+EBP]
    74 0000008E 05 00000414                     	ADD	EAX,1044
    75 00000093                                 L18:
    76 00000093 83 78 1C 00                     	CMP	DWORD [28+EAX],0
    77 00000097 74 10                           	JE	L21
    78 00000099 42                              	INC	EDX
    79 0000009A 83 C0 2C                        	ADD	EAX,44
    80 0000009D 81 FA 000000FF                  	CMP	EDX,255
    81 000000A3 7E EE                           	JLE	L18
    82 000000A5 31 C0                           	XOR	EAX,EAX
    83 000000A7                                 L12:
    84 000000A7 5D                              	POP	EBP
    85 000000A8 C3                              	RET
    86 000000A9                                 L21:
    87 000000A9 C7 40 1C 00000001               	MOV	DWORD [28+EAX],1
    88 000000B0 C7 40 18 FFFFFFFF               	MOV	DWORD [24+EAX],-1
    89 000000B7 C7 40 24 00000000               	MOV	DWORD [36+EAX],0
    90 000000BE EB E7                           	JMP	L12
    91 000000C0                                 	GLOBAL	_sheet_setbuf
    92 000000C0                                 _sheet_setbuf:
    93 000000C0 55                              	PUSH	EBP
    94 000000C1 89 E5                           	MOV	EBP,ESP
    95 000000C3 8B 55 08                        	MOV	EDX,DWORD [8+EBP]
    96 000000C6 8B 45 0C                        	MOV	EAX,DWORD [12+EBP]
    97 000000C9 8B 4D 18                        	MOV	ECX,DWORD [24+EBP]
    98 000000CC 89 02                           	MOV	DWORD [EDX],EAX
    99 000000CE 83 F9 FF                        	CMP	ECX,-1
   100 000000D1 8B 45 10                        	MOV	EAX,DWORD [16+EBP]
   101 000000D4 89 42 04                        	MOV	DWORD [4+EDX],EAX
   102 000000D7 8B 45 14                        	MOV	EAX,DWORD [20+EBP]
   103 000000DA 89 42 08                        	MOV	DWORD [8+EDX],EAX
   104 000000DD 74 0D                           	JE	L23
   105 000000DF 0F B7 84 09 [00000000]          	MOVZX	EAX,WORD [_table_8_565+ECX+ECX*1]
   106 000000E7 89 42 14                        	MOV	DWORD [20+EDX],EAX
   107 000000EA                                 L22:
   108 000000EA 5D                              	POP	EBP
   109 000000EB C3                              	RET
   110 000000EC                                 L23:
   111 000000EC C7 42 14 FFFFFFFF               	MOV	DWORD [20+EDX],-1
   112 000000F3 EB F5                           	JMP	L22
   113 000000F5                                 	GLOBAL	_sheet_refreshmap
   114 000000F5                                 _sheet_refreshmap:
   115 000000F5 55                              	PUSH	EBP
   116 000000F6 89 E5                           	MOV	EBP,ESP
   117 000000F8 57                              	PUSH	EDI
   118 000000F9 56                              	PUSH	ESI
   119 000000FA 53                              	PUSH	EBX
   120 000000FB 83 EC 30                        	SUB	ESP,48
   121 000000FE 8B 45 08                        	MOV	EAX,DWORD [8+EBP]
   122 00000101 83 7D 0C 00                     	CMP	DWORD [12+EBP],0
   123 00000105 8B 40 04                        	MOV	EAX,DWORD [4+EAX]
   124 00000108 89 45 D8                        	MOV	DWORD [-40+EBP],EAX
   125 0000010B 0F 88 00000203                  	JS	L85
   126 00000111                                 L26:
   127 00000111 83 7D 10 00                     	CMP	DWORD [16+EBP],0
   128 00000115 0F 88 000001ED                  	JS	L86
   129 0000011B                                 L27:
   130 0000011B 8B 55 08                        	MOV	EDX,DWORD [8+EBP]
   131 0000011E 8B 42 08                        	MOV	EAX,DWORD [8+EDX]
   132 00000121 39 45 14                        	CMP	DWORD [20+EBP],EAX
   133 00000124 7E 03                           	JLE	L28
   134 00000126 89 45 14                        	MOV	DWORD [20+EBP],EAX
   135 00000129                                 L28:
   136 00000129 8B 4D 08                        	MOV	ECX,DWORD [8+EBP]
   137 0000012C 8B 41 0C                        	MOV	EAX,DWORD [12+ECX]
   138 0000012F 39 45 18                        	CMP	DWORD [24+EBP],EAX
   139 00000132 7E 03                           	JLE	L29
   140 00000134 89 45 18                        	MOV	DWORD [24+EBP],EAX
   141 00000137                                 L29:
   142 00000137 8B 75 08                        	MOV	ESI,DWORD [8+EBP]
   143 0000013A 8B 5D 1C                        	MOV	EBX,DWORD [28+EBP]
   144 0000013D 89 5D F0                        	MOV	DWORD [-16+EBP],EBX
   145 00000140 3B 5E 10                        	CMP	EBX,DWORD [16+ESI]
   146 00000143 0F 8F 000000DA                  	JG	L75
   147 00000149                                 L73:
   148 00000149 8B 55 08                        	MOV	EDX,DWORD [8+EBP]
   149 0000014C 8B 45 F0                        	MOV	EAX,DWORD [-16+EBP]
   150 0000014F 8B 75 18                        	MOV	ESI,DWORD [24+EBP]
   151 00000152 8B 5D 14                        	MOV	EBX,DWORD [20+EBP]
   152 00000155 8B 7C 82 14                     	MOV	EDI,DWORD [20+EDX+EAX*4]
   153 00000159 89 F8                           	MOV	EAX,EDI
   154 0000015B 29 D0                           	SUB	EAX,EDX
   155 0000015D 8B 0F                           	MOV	ECX,DWORD [EDI]
   156 0000015F 2D 00000414                     	SUB	EAX,1044
   157 00000164 89 4D D4                        	MOV	DWORD [-44+EBP],ECX
   158 00000167 C1 F8 02                        	SAR	EAX,2
   159 0000016A 8B 4D 10                        	MOV	ECX,DWORD [16+EBP]
   160 0000016D 69 C0 BA2E8BA3                  	IMUL	EAX,EAX,-1171354717
   161 00000173 88 45 DF                        	MOV	BYTE [-33+EBP],AL
   162 00000176 8B 57 0C                        	MOV	EDX,DWORD [12+EDI]
   163 00000179 8B 47 10                        	MOV	EAX,DWORD [16+EDI]
   164 0000017C 29 D3                           	SUB	EBX,EDX
   165 0000017E 29 C6                           	SUB	ESI,EAX
   166 00000180 29 C1                           	SUB	ECX,EAX
   167 00000182 8B 45 0C                        	MOV	EAX,DWORD [12+EBP]
   168 00000185 89 5D E8                        	MOV	DWORD [-24+EBP],EBX
   169 00000188 29 D0                           	SUB	EAX,EDX
   170 0000018A 89 75 E4                        	MOV	DWORD [-28+EBP],ESI
   171 0000018D 89 45 EC                        	MOV	DWORD [-20+EBP],EAX
   172 00000190 0F 88 00000166                  	JS	L87
   173 00000196                                 L34:
   174 00000196 85 C9                           	TEST	ECX,ECX
   175 00000198 0F 88 00000157                  	JS	L88
   176 0000019E                                 L35:
   177 0000019E 8B 47 04                        	MOV	EAX,DWORD [4+EDI]
   178 000001A1 39 45 E8                        	CMP	DWORD [-24+EBP],EAX
   179 000001A4 7E 03                           	JLE	L36
   180 000001A6 89 45 E8                        	MOV	DWORD [-24+EBP],EAX
   181 000001A9                                 L36:
   182 000001A9 8B 47 08                        	MOV	EAX,DWORD [8+EDI]
   183 000001AC 39 45 E4                        	CMP	DWORD [-28+EBP],EAX
   184 000001AF 7E 03                           	JLE	L37
   185 000001B1 89 45 E4                        	MOV	DWORD [-28+EBP],EAX
   186 000001B4                                 L37:
   187 000001B4 83 7F 14 FF                     	CMP	DWORD [20+EDI],-1
   188 000001B8 74 71                           	JE	L89
   189 000001BA 89 CA                           	MOV	EDX,ECX
   190 000001BC 3B 4D E4                        	CMP	ECX,DWORD [-28+EBP]
   191 000001BF 7D 50                           	JGE	L32
   192 000001C1                                 L72:
   193 000001C1 8B 47 10                        	MOV	EAX,DWORD [16+EDI]
   194 000001C4 8B 4D EC                        	MOV	ECX,DWORD [-20+EBP]
   195 000001C7 01 D0                           	ADD	EAX,EDX
   196 000001C9 3B 4D E8                        	CMP	ECX,DWORD [-24+EBP]
   197 000001CC 89 45 C4                        	MOV	DWORD [-60+EBP],EAX
   198 000001CF 7D 3A                           	JGE	L84
   199 000001D1                                 L71:
   200 000001D1 89 D0                           	MOV	EAX,EDX
   201 000001D3 8B 75 D4                        	MOV	ESI,DWORD [-44+EBP]
   202 000001D6 0F AF 47 04                     	IMUL	EAX,DWORD [4+EDI]
   203 000001DA 01 C8                           	ADD	EAX,ECX
   204 000001DC 8B 5F 0C                        	MOV	EBX,DWORD [12+EDI]
   205 000001DF 01 CB                           	ADD	EBX,ECX
   206 000001E1 0F B7 34 46                     	MOVZX	ESI,WORD [ESI+EAX*2]
   207 000001E5 89 5D C8                        	MOV	DWORD [-56+EBP],EBX
   208 000001E8 3B 77 14                        	CMP	ESI,DWORD [20+EDI]
   209 000001EB 74 18                           	JE	L68
   210 000001ED 8B 45 08                        	MOV	EAX,DWORD [8+EBP]
   211 000001F0 8B 5D C4                        	MOV	EBX,DWORD [-60+EBP]
   212 000001F3 8B 75 C8                        	MOV	ESI,DWORD [-56+EBP]
   213 000001F6 0F AF 58 08                     	IMUL	EBX,DWORD [8+EAX]
   214 000001FA 01 DE                           	ADD	ESI,EBX
   215 000001FC 8A 45 DF                        	MOV	AL,BYTE [-33+EBP]
   216 000001FF 8B 5D D8                        	MOV	EBX,DWORD [-40+EBP]
   217 00000202 88 04 1E                        	MOV	BYTE [ESI+EBX*1],AL
   218 00000205                                 L68:
   219 00000205 41                              	INC	ECX
   220 00000206 3B 4D E8                        	CMP	ECX,DWORD [-24+EBP]
   221 00000209 7C C6                           	JL	L71
   222 0000020B                                 L84:
   223 0000020B 42                              	INC	EDX
   224 0000020C 3B 55 E4                        	CMP	EDX,DWORD [-28+EBP]
   225 0000020F 7C B0                           	JL	L72
   226 00000211                                 L32:
   227 00000211 8B 45 08                        	MOV	EAX,DWORD [8+EBP]
   228 00000214 FF 45 F0                        	INC	DWORD [-16+EBP]
   229 00000217 8B 75 F0                        	MOV	ESI,DWORD [-16+EBP]
   230 0000021A 3B 70 10                        	CMP	ESI,DWORD [16+EAX]
   231 0000021D 0F 8E FFFFFF26                  	JLE	L73
   232 00000223                                 L75:
   233 00000223 83 C4 30                        	ADD	ESP,48
   234 00000226 5B                              	POP	EBX
   235 00000227 5E                              	POP	ESI
   236 00000228 5F                              	POP	EDI
   237 00000229 5D                              	POP	EBP
   238 0000022A C3                              	RET
   239 0000022B                                 L89:
   240 0000022B 83 E2 03                        	AND	EDX,3
   241 0000022E 75 7F                           	JNE	L39
   242 00000230 F7 45 EC 00000003               	TEST	DWORD [-20+EBP],3
   243 00000237 75 76                           	JNE	L39
   244 00000239 F7 45 E8 00000003               	TEST	DWORD [-24+EBP],3
   245 00000240 75 6D                           	JNE	L39
   246 00000242 8B 55 EC                        	MOV	EDX,DWORD [-20+EBP]
   247 00000245 29 55 E8                        	SUB	DWORD [-24+EBP],EDX
   248 00000248 BA 00000004                     	MOV	EDX,4
   249 0000024D 89 D3                           	MOV	EBX,EDX
   250 0000024F 8B 45 E8                        	MOV	EAX,DWORD [-24+EBP]
   251 00000252 99                              	CDQ
   252 00000253 F7 FB                           	IDIV	EBX
   253 00000255 89 45 D0                        	MOV	DWORD [-48+EBP],EAX
   254 00000258 89 CA                           	MOV	EDX,ECX
   255 0000025A 0F B6 45 DF                     	MOVZX	EAX,BYTE [-33+EBP]
   256 0000025E 89 C6                           	MOV	ESI,EAX
   257 00000260 C1 E6 08                        	SAL	ESI,8
   258 00000263 09 C6                           	OR	ESI,EAX
   259 00000265 C1 E0 10                        	SAL	EAX,16
   260 00000268 09 C6                           	OR	ESI,EAX
   261 0000026A C1 E0 08                        	SAL	EAX,8
   262 0000026D 09 C6                           	OR	ESI,EAX
   263 0000026F 3B 4D E4                        	CMP	ECX,DWORD [-28+EBP]
   264 00000272 89 75 E0                        	MOV	DWORD [-32+EBP],ESI
   265 00000275 7D 9A                           	JGE	L32
   266 00000277                                 L49:
   267 00000277 8B 47 10                        	MOV	EAX,DWORD [16+EDI]
   268 0000027A 8B 5D 08                        	MOV	EBX,DWORD [8+EBP]
   269 0000027D 01 D0                           	ADD	EAX,EDX
   270 0000027F 8B 4D EC                        	MOV	ECX,DWORD [-20+EBP]
   271 00000282 0F AF 43 08                     	IMUL	EAX,DWORD [8+EBX]
   272 00000286 03 4F 0C                        	ADD	ECX,DWORD [12+EDI]
   273 00000289 89 45 C4                        	MOV	DWORD [-60+EBP],EAX
   274 0000028C 01 C8                           	ADD	EAX,ECX
   275 0000028E 31 C9                           	XOR	ECX,ECX
   276 00000290 03 45 D8                        	ADD	EAX,DWORD [-40+EBP]
   277 00000293 3B 4D D0                        	CMP	ECX,DWORD [-48+EBP]
   278 00000296 7D 0C                           	JGE	L78
   279 00000298                                 L48:
   280 00000298 8B 75 E0                        	MOV	ESI,DWORD [-32+EBP]
   281 0000029B 89 34 88                        	MOV	DWORD [EAX+ECX*4],ESI
   282 0000029E 41                              	INC	ECX
   283 0000029F 3B 4D D0                        	CMP	ECX,DWORD [-48+EBP]
   284 000002A2 7C F4                           	JL	L48
   285 000002A4                                 L78:
   286 000002A4 42                              	INC	EDX
   287 000002A5 3B 55 E4                        	CMP	EDX,DWORD [-28+EBP]
   288 000002A8 7C CD                           	JL	L49
   289 000002AA E9 FFFFFF62                     	JMP	L32
   290 000002AF                                 L39:
   291 000002AF 89 CA                           	MOV	EDX,ECX
   292 000002B1 3B 4D E4                        	CMP	ECX,DWORD [-28+EBP]
   293 000002B4 0F 8D FFFFFF57                  	JGE	L32
   294 000002BA                                 L60:
   295 000002BA 8B 47 10                        	MOV	EAX,DWORD [16+EDI]
   296 000002BD 8B 4D EC                        	MOV	ECX,DWORD [-20+EBP]
   297 000002C0 01 D0                           	ADD	EAX,EDX
   298 000002C2 3B 4D E8                        	CMP	ECX,DWORD [-24+EBP]
   299 000002C5 89 45 C4                        	MOV	DWORD [-60+EBP],EAX
   300 000002C8 7D 20                           	JGE	L81
   301 000002CA                                 L59:
   302 000002CA 8B 75 08                        	MOV	ESI,DWORD [8+EBP]
   303 000002CD 8B 45 C4                        	MOV	EAX,DWORD [-60+EBP]
   304 000002D0 8B 5F 0C                        	MOV	EBX,DWORD [12+EDI]
   305 000002D3 0F AF 46 08                     	IMUL	EAX,DWORD [8+ESI]
   306 000002D7 01 CB                           	ADD	EBX,ECX
   307 000002D9 8B 75 D8                        	MOV	ESI,DWORD [-40+EBP]
   308 000002DC 01 C3                           	ADD	EBX,EAX
   309 000002DE 41                              	INC	ECX
   310 000002DF 8A 45 DF                        	MOV	AL,BYTE [-33+EBP]
   311 000002E2 88 04 33                        	MOV	BYTE [EBX+ESI*1],AL
   312 000002E5 3B 4D E8                        	CMP	ECX,DWORD [-24+EBP]
   313 000002E8 7C E0                           	JL	L59
   314 000002EA                                 L81:
   315 000002EA 42                              	INC	EDX
   316 000002EB 3B 55 E4                        	CMP	EDX,DWORD [-28+EBP]
   317 000002EE 7C CA                           	JL	L60
   318 000002F0 E9 FFFFFF1C                     	JMP	L32
   319 000002F5                                 L88:
   320 000002F5 31 C9                           	XOR	ECX,ECX
   321 000002F7 E9 FFFFFEA2                     	JMP	L35
   322 000002FC                                 L87:
   323 000002FC C7 45 EC 00000000               	MOV	DWORD [-20+EBP],0
   324 00000303 E9 FFFFFE8E                     	JMP	L34
   325 00000308                                 L86:
   326 00000308 C7 45 10 00000000               	MOV	DWORD [16+EBP],0
   327 0000030F E9 FFFFFE07                     	JMP	L27
   328 00000314                                 L85:
   329 00000314 C7 45 0C 00000000               	MOV	DWORD [12+EBP],0
   330 0000031B E9 FFFFFDF1                     	JMP	L26
   331 00000320                                 	GLOBAL	_sheet_refreshsub
   332 00000320                                 _sheet_refreshsub:
   333 00000320 55                              	PUSH	EBP
   334 00000321 89 E5                           	MOV	EBP,ESP
   335 00000323 57                              	PUSH	EDI
   336 00000324 56                              	PUSH	ESI
   337 00000325 53                              	PUSH	EBX
   338 00000326 83 EC 54                        	SUB	ESP,84
   339 00000329 8B 45 08                        	MOV	EAX,DWORD [8+EBP]
   340 0000032C 8B 55 08                        	MOV	EDX,DWORD [8+EBP]
   341 0000032F 83 7D 0C 00                     	CMP	DWORD [12+EBP],0
   342 00000333 8B 00                           	MOV	EAX,DWORD [EAX]
   343 00000335 8B 52 04                        	MOV	EDX,DWORD [4+EDX]
   344 00000338 89 45 D0                        	MOV	DWORD [-48+EBP],EAX
   345 0000033B 89 55 CC                        	MOV	DWORD [-52+EBP],EDX
   346 0000033E 0F 88 000003AD                  	JS	L171
   347 00000344                                 L91:
   348 00000344 83 7D 10 00                     	CMP	DWORD [16+EBP],0
   349 00000348 0F 88 00000397                  	JS	L172
   350 0000034E                                 L92:
   351 0000034E 8B 5D 08                        	MOV	EBX,DWORD [8+EBP]
   352 00000351 8B 43 08                        	MOV	EAX,DWORD [8+EBX]
   353 00000354 39 45 14                        	CMP	DWORD [20+EBP],EAX
   354 00000357 7E 03                           	JLE	L93
   355 00000359 89 45 14                        	MOV	DWORD [20+EBP],EAX
   356 0000035C                                 L93:
   357 0000035C 8B 55 08                        	MOV	EDX,DWORD [8+EBP]
   358 0000035F 8B 42 0C                        	MOV	EAX,DWORD [12+EDX]
   359 00000362 39 45 18                        	CMP	DWORD [24+EBP],EAX
   360 00000365 7E 03                           	JLE	L94
   361 00000367 89 45 18                        	MOV	DWORD [24+EBP],EAX
   362 0000036A                                 L94:
   363 0000036A 8B 5D 1C                        	MOV	EBX,DWORD [28+EBP]
   364 0000036D 8B 45 20                        	MOV	EAX,DWORD [32+EBP]
   365 00000370 89 5D F0                        	MOV	DWORD [-16+EBP],EBX
   366 00000373 39 C3                           	CMP	EBX,EAX
   367 00000375 0F 8F 000001F6                  	JG	L158
   368 0000037B                                 L156:
   369 0000037B 8B 5D 08                        	MOV	EBX,DWORD [8+EBP]
   370 0000037E 8B 55 F0                        	MOV	EDX,DWORD [-16+EBP]
   371 00000381 8B 4D 10                        	MOV	ECX,DWORD [16+EBP]
   372 00000384 8B 7C 93 14                     	MOV	EDI,DWORD [20+EBX+EDX*4]
   373 00000388 8B 07                           	MOV	EAX,DWORD [EDI]
   374 0000038A 8B 57 0C                        	MOV	EDX,DWORD [12+EDI]
   375 0000038D 89 45 C4                        	MOV	DWORD [-60+EBP],EAX
   376 00000390 89 55 B8                        	MOV	DWORD [-72+EBP],EDX
   377 00000393 89 F8                           	MOV	EAX,EDI
   378 00000395 29 D8                           	SUB	EAX,EBX
   379 00000397 8B 5F 10                        	MOV	EBX,DWORD [16+EDI]
   380 0000039A 2D 00000414                     	SUB	EAX,1044
   381 0000039F 29 D9                           	SUB	ECX,EBX
   382 000003A1 C1 F8 02                        	SAR	EAX,2
   383 000003A4 89 5D B4                        	MOV	DWORD [-76+EBP],EBX
   384 000003A7 69 C0 BA2E8BA3                  	IMUL	EAX,EAX,-1171354717
   385 000003AD 88 45 CB                        	MOV	BYTE [-53+EBP],AL
   386 000003B0 8B 45 14                        	MOV	EAX,DWORD [20+EBP]
   387 000003B3 29 D0                           	SUB	EAX,EDX
   388 000003B5 8B 55 18                        	MOV	EDX,DWORD [24+EBP]
   389 000003B8 29 DA                           	SUB	EDX,EBX
   390 000003BA 89 45 E4                        	MOV	DWORD [-28+EBP],EAX
   391 000003BD 8B 5D 0C                        	MOV	EBX,DWORD [12+EBP]
   392 000003C0 89 55 E0                        	MOV	DWORD [-32+EBP],EDX
   393 000003C3 2B 5D B8                        	SUB	EBX,DWORD [-72+EBP]
   394 000003C6 89 5D E8                        	MOV	DWORD [-24+EBP],EBX
   395 000003C9 0F 88 0000030A                  	JS	L173
   396 000003CF                                 L99:
   397 000003CF 85 C9                           	TEST	ECX,ECX
   398 000003D1 0F 88 000002FB                  	JS	L174
   399 000003D7                                 L100:
   400 000003D7 8B 47 04                        	MOV	EAX,DWORD [4+EDI]
   401 000003DA 89 45 B0                        	MOV	DWORD [-80+EBP],EAX
   402 000003DD 39 45 E4                        	CMP	DWORD [-28+EBP],EAX
   403 000003E0 7E 03                           	JLE	L101
   404 000003E2 89 45 E4                        	MOV	DWORD [-28+EBP],EAX
   405 000003E5                                 L101:
   406 000003E5 8B 47 08                        	MOV	EAX,DWORD [8+EDI]
   407 000003E8 39 45 E0                        	CMP	DWORD [-32+EBP],EAX
   408 000003EB 7E 03                           	JLE	L102
   409 000003ED 89 45 E0                        	MOV	DWORD [-32+EBP],EAX
   410 000003F0                                 L102:
   411 000003F0 80 3D 00000FF2 08               	CMP	BYTE [4082],8
   412 000003F7 0F 84 00000276                  	JE	L175
   413 000003FD F7 45 B8 00000002               	TEST	DWORD [-72+EBP],2
   414 00000404 0F 85 000001F3                  	JNE	L116
   415 0000040A 8B 55 E8                        	MOV	EDX,DWORD [-24+EBP]
   416 0000040D BE 00000002                     	MOV	ESI,2
   417 00000412 42                              	INC	EDX
   418 00000413 89 D0                           	MOV	EAX,EDX
   419 00000415 99                              	CDQ
   420 00000416 F7 FE                           	IDIV	ESI
   421 00000418 89 45 A0                        	MOV	DWORD [-96+EBP],EAX
   422 0000041B 8B 45 E4                        	MOV	EAX,DWORD [-28+EBP]
   423 0000041E 99                              	CDQ
   424 0000041F F7 FE                           	IDIV	ESI
   425 00000421 8B 55 A0                        	MOV	EDX,DWORD [-96+EBP]
   426 00000424 89 CE                           	MOV	ESI,ECX
   427 00000426 29 D0                           	SUB	EAX,EDX
   428 00000428 89 45 DC                        	MOV	DWORD [-36+EBP],EAX
   429 0000042B 66 0F B6 5D CB                  	MOVZX	BX,BYTE [-53+EBP]
   430 00000430 0F B6 45 CB                     	MOVZX	EAX,BYTE [-53+EBP]
   431 00000434 C1 E0 08                        	SAL	EAX,8
   432 00000437 66 89 5D C2                     	MOV	WORD [-62+EBP],BX
   433 0000043B 66 09 45 C2                     	OR	WORD [-62+EBP],AX
   434 0000043F 3B 4D E0                        	CMP	ECX,DWORD [-32+EBP]
   435 00000442 0F 8D 0000011A                  	JGE	L97
   436 00000448                                 L143:
   437 00000448 8B 47 10                        	MOV	EAX,DWORD [16+EDI]
   438 0000044B 8B 4D E8                        	MOV	ECX,DWORD [-24+EBP]
   439 0000044E 01 F0                           	ADD	EAX,ESI
   440 00000450 3B 4D E4                        	CMP	ECX,DWORD [-28+EBP]
   441 00000453 89 45 EC                        	MOV	DWORD [-20+EBP],EAX
   442 00000456 7D 37                           	JGE	L122
   443 00000458 F7 C1 00000001                  	TEST	ECX,1
   444 0000045E 74 2F                           	JE	L122
   445 00000460                                 L127:
   446 00000460 8B 5D 08                        	MOV	EBX,DWORD [8+EBP]
   447 00000463 8B 45 EC                        	MOV	EAX,DWORD [-20+EBP]
   448 00000466 8B 57 0C                        	MOV	EDX,DWORD [12+EDI]
   449 00000469 0F AF 43 08                     	IMUL	EAX,DWORD [8+EBX]
   450 0000046D 01 CA                           	ADD	EDX,ECX
   451 0000046F 8B 5D CC                        	MOV	EBX,DWORD [-52+EBP]
   452 00000472 8D 14 02                        	LEA	EDX,DWORD [EDX+EAX*1]
   453 00000475 8A 45 CB                        	MOV	AL,BYTE [-53+EBP]
   454 00000478 38 04 1A                        	CMP	BYTE [EDX+EBX*1],AL
   455 0000047B 0F 84 00000161                  	JE	L176
   456 00000481                                 L123:
   457 00000481 41                              	INC	ECX
   458 00000482 3B 4D E4                        	CMP	ECX,DWORD [-28+EBP]
   459 00000485 7D 08                           	JGE	L122
   460 00000487 F7 C1 00000001                  	TEST	ECX,1
   461 0000048D 75 D1                           	JNE	L127
   462 0000048F                                 L122:
   463 0000048F 8B 5D 08                        	MOV	EBX,DWORD [8+EBP]
   464 00000492 8B 45 EC                        	MOV	EAX,DWORD [-20+EBP]
   465 00000495 8B 57 0C                        	MOV	EDX,DWORD [12+EDI]
   466 00000498 0F AF 43 08                     	IMUL	EAX,DWORD [8+EBX]
   467 0000049C 01 CA                           	ADD	EDX,ECX
   468 0000049E 8B 5D D0                        	MOV	EBX,DWORD [-48+EBP]
   469 000004A1 01 D0                           	ADD	EAX,EDX
   470 000004A3 8B 55 CC                        	MOV	EDX,DWORD [-52+EBP]
   471 000004A6 01 C2                           	ADD	EDX,EAX
   472 000004A8 8D 04 43                        	LEA	EAX,DWORD [EBX+EAX*2]
   473 000004AB 89 55 BC                        	MOV	DWORD [-68+EBP],EDX
   474 000004AE 89 45 D8                        	MOV	DWORD [-40+EBP],EAX
   475 000004B1 8B 55 C4                        	MOV	EDX,DWORD [-60+EBP]
   476 000004B4 89 F0                           	MOV	EAX,ESI
   477 000004B6 8B 5D DC                        	MOV	EBX,DWORD [-36+EBP]
   478 000004B9 0F AF 47 04                     	IMUL	EAX,DWORD [4+EDI]
   479 000004BD 01 C8                           	ADD	EAX,ECX
   480 000004BF C7 45 A0 00000000               	MOV	DWORD [-96+EBP],0
   481 000004C6 8D 04 42                        	LEA	EAX,DWORD [EDX+EAX*2]
   482 000004C9 39 5D A0                        	CMP	DWORD [-96+EBP],EBX
   483 000004CC 89 45 D4                        	MOV	DWORD [-44+EBP],EAX
   484 000004CF 7D 59                           	JGE	L165
   485 000004D1 89 4D AC                        	MOV	DWORD [-84+EBP],ECX
   486 000004D4                                 L136:
   487 000004D4 66 8B 5D C2                     	MOV	BX,WORD [-62+EBP]
   488 000004D8 8B 45 A0                        	MOV	EAX,DWORD [-96+EBP]
   489 000004DB 8B 55 BC                        	MOV	EDX,DWORD [-68+EBP]
   490 000004DE 66 39 1C 42                     	CMP	WORD [EDX+EAX*2],BX
   491 000004E2 0F 84 000000E6                  	JE	L177
   492 000004E8 8B 5D 08                        	MOV	EBX,DWORD [8+EBP]
   493 000004EB 8B 45 EC                        	MOV	EAX,DWORD [-20+EBP]
   494 000004EE 8B 55 AC                        	MOV	EDX,DWORD [-84+EBP]
   495 000004F1 0F AF 43 08                     	IMUL	EAX,DWORD [8+EBX]
   496 000004F5 03 57 0C                        	ADD	EDX,DWORD [12+EDI]
   497 000004F8 8A 5D CB                        	MOV	BL,BYTE [-53+EBP]
   498 000004FB 01 C2                           	ADD	EDX,EAX
   499 000004FD 8B 45 CC                        	MOV	EAX,DWORD [-52+EBP]
   500 00000500 89 55 A4                        	MOV	DWORD [-92+EBP],EDX
   501 00000503 38 1C 02                        	CMP	BYTE [EDX+EAX*1],BL
   502 00000506 0F 84 000000A3                  	JE	L178
   503 0000050C                                 L134:
   504 0000050C 8B 45 CC                        	MOV	EAX,DWORD [-52+EBP]
   505 0000050F 8B 55 A4                        	MOV	EDX,DWORD [-92+EBP]
   506 00000512 8A 5D CB                        	MOV	BL,BYTE [-53+EBP]
   507 00000515 38 5C 02 01                     	CMP	BYTE [1+EDX+EAX*1],BL
   508 00000519 74 76                           	JE	L179
   509 0000051B                                 L130:
   510 0000051B 8B 45 DC                        	MOV	EAX,DWORD [-36+EBP]
   511 0000051E FF 45 A0                        	INC	DWORD [-96+EBP]
   512 00000521 83 45 AC 02                     	ADD	DWORD [-84+EBP],2
   513 00000525 39 45 A0                        	CMP	DWORD [-96+EBP],EAX
   514 00000528 7C AA                           	JL	L136
   515 0000052A                                 L165:
   516 0000052A 8B 55 DC                        	MOV	EDX,DWORD [-36+EBP]
   517 0000052D 8D 0C 51                        	LEA	ECX,DWORD [ECX+EDX*2]
   518 00000530 3B 4D E4                        	CMP	ECX,DWORD [-28+EBP]
   519 00000533 7D 23                           	JGE	L167
   520 00000535                                 L142:
   521 00000535 8B 5D 08                        	MOV	EBX,DWORD [8+EBP]
   522 00000538 8B 45 EC                        	MOV	EAX,DWORD [-20+EBP]
   523 0000053B 8B 57 0C                        	MOV	EDX,DWORD [12+EDI]
   524 0000053E 0F AF 43 08                     	IMUL	EAX,DWORD [8+EBX]
   525 00000542 01 CA                           	ADD	EDX,ECX
   526 00000544 8B 5D CC                        	MOV	EBX,DWORD [-52+EBP]
   527 00000547 8D 14 02                        	LEA	EDX,DWORD [EDX+EAX*1]
   528 0000054A 8A 45 CB                        	MOV	AL,BYTE [-53+EBP]
   529 0000054D 38 04 1A                        	CMP	BYTE [EDX+EBX*1],AL
   530 00000550 74 27                           	JE	L180
   531 00000552                                 L139:
   532 00000552 41                              	INC	ECX
   533 00000553 3B 4D E4                        	CMP	ECX,DWORD [-28+EBP]
   534 00000556 7C DD                           	JL	L142
   535 00000558                                 L167:
   536 00000558 46                              	INC	ESI
   537 00000559 3B 75 E0                        	CMP	ESI,DWORD [-32+EBP]
   538 0000055C 0F 8C FFFFFEE6                  	JL	L143
   539 00000562                                 L97:
   540 00000562 8B 5D 20                        	MOV	EBX,DWORD [32+EBP]
   541 00000565 FF 45 F0                        	INC	DWORD [-16+EBP]
   542 00000568 39 5D F0                        	CMP	DWORD [-16+EBP],EBX
   543 0000056B 0F 8E FFFFFE0A                  	JLE	L156
   544 00000571                                 L158:
   545 00000571 83 C4 54                        	ADD	ESP,84
   546 00000574 5B                              	POP	EBX
   547 00000575 5E                              	POP	ESI
   548 00000576 5F                              	POP	EDI
   549 00000577 5D                              	POP	EBP
   550 00000578 C3                              	RET
   551 00000579                                 L180:
   552 00000579 89 F0                           	MOV	EAX,ESI
   553 0000057B 8B 5D C4                        	MOV	EBX,DWORD [-60+EBP]
   554 0000057E 0F AF 47 04                     	IMUL	EAX,DWORD [4+EDI]
   555 00000582 01 C8                           	ADD	EAX,ECX
   556 00000584 66 8B 04 43                     	MOV	AX,WORD [EBX+EAX*2]
   557 00000588 8B 5D D0                        	MOV	EBX,DWORD [-48+EBP]
   558 0000058B 66 89 04 53                     	MOV	WORD [EBX+EDX*2],AX
   559 0000058F EB C1                           	JMP	L139
   560 00000591                                 L179:
   561 00000591 89 F0                           	MOV	EAX,ESI
   562 00000593 8B 5D C4                        	MOV	EBX,DWORD [-60+EBP]
   563 00000596 0F AF 47 04                     	IMUL	EAX,DWORD [4+EDI]
   564 0000059A 03 45 AC                        	ADD	EAX,DWORD [-84+EBP]
   565 0000059D 66 8B 44 43 02                  	MOV	AX,WORD [2+EBX+EAX*2]
   566 000005A2 8B 5D D0                        	MOV	EBX,DWORD [-48+EBP]
   567 000005A5 66 89 44 53 02                  	MOV	WORD [2+EBX+EDX*2],AX
   568 000005AA E9 FFFFFF6C                     	JMP	L130
   569 000005AF                                 L178:
   570 000005AF 89 F0                           	MOV	EAX,ESI
   571 000005B1 8B 55 C4                        	MOV	EDX,DWORD [-60+EBP]
   572 000005B4 0F AF 47 04                     	IMUL	EAX,DWORD [4+EDI]
   573 000005B8 03 45 AC                        	ADD	EAX,DWORD [-84+EBP]
   574 000005BB 8B 5D A4                        	MOV	EBX,DWORD [-92+EBP]
   575 000005BE 66 8B 04 42                     	MOV	AX,WORD [EDX+EAX*2]
   576 000005C2 8B 55 D0                        	MOV	EDX,DWORD [-48+EBP]
   577 000005C5 66 89 04 5A                     	MOV	WORD [EDX+EBX*2],AX
   578 000005C9 E9 FFFFFF3E                     	JMP	L134
   579 000005CE                                 L177:
   580 000005CE 8B 55 D4                        	MOV	EDX,DWORD [-44+EBP]
   581 000005D1 8B 5D A0                        	MOV	EBX,DWORD [-96+EBP]
   582 000005D4 8B 04 82                        	MOV	EAX,DWORD [EDX+EAX*4]
   583 000005D7 8B 55 D8                        	MOV	EDX,DWORD [-40+EBP]
   584 000005DA 89 04 9A                        	MOV	DWORD [EDX+EBX*4],EAX
   585 000005DD E9 FFFFFF39                     	JMP	L130
   586 000005E2                                 L176:
   587 000005E2 89 F0                           	MOV	EAX,ESI
   588 000005E4 8B 5D C4                        	MOV	EBX,DWORD [-60+EBP]
   589 000005E7 0F AF 47 04                     	IMUL	EAX,DWORD [4+EDI]
   590 000005EB 01 C8                           	ADD	EAX,ECX
   591 000005ED 66 8B 04 43                     	MOV	AX,WORD [EBX+EAX*2]
   592 000005F1 8B 5D D0                        	MOV	EBX,DWORD [-48+EBP]
   593 000005F4 66 89 04 53                     	MOV	WORD [EBX+EDX*2],AX
   594 000005F8 E9 FFFFFE84                     	JMP	L123
   595 000005FD                                 L116:
   596 000005FD 89 CE                           	MOV	ESI,ECX
   597 000005FF 3B 4D E0                        	CMP	ECX,DWORD [-32+EBP]
   598 00000602 0F 8D FFFFFF5A                  	JGE	L97
   599 00000608 8B 7D B0                        	MOV	EDI,DWORD [-80+EBP]
   600 0000060B 0F AF F9                        	IMUL	EDI,ECX
   601 0000060E                                 L155:
   602 0000060E 8B 45 B4                        	MOV	EAX,DWORD [-76+EBP]
   603 00000611 8B 4D E8                        	MOV	ECX,DWORD [-24+EBP]
   604 00000614 01 F0                           	ADD	EAX,ESI
   605 00000616 3B 4D E4                        	CMP	ECX,DWORD [-28+EBP]
   606 00000619 89 45 EC                        	MOV	DWORD [-20+EBP],EAX
   607 0000061C 7D 35                           	JGE	L170
   608 0000061E 8D 04 39                        	LEA	EAX,DWORD [ECX+EDI*1]
   609 00000621 8B 55 C4                        	MOV	EDX,DWORD [-60+EBP]
   610 00000624 8D 04 42                        	LEA	EAX,DWORD [EDX+EAX*2]
   611 00000627 89 45 A0                        	MOV	DWORD [-96+EBP],EAX
   612 0000062A                                 L154:
   613 0000062A 8B 5D 08                        	MOV	EBX,DWORD [8+EBP]
   614 0000062D 8B 45 EC                        	MOV	EAX,DWORD [-20+EBP]
   615 00000630 8B 55 B8                        	MOV	EDX,DWORD [-72+EBP]
   616 00000633 0F AF 43 08                     	IMUL	EAX,DWORD [8+EBX]
   617 00000637 01 CA                           	ADD	EDX,ECX
   618 00000639 8A 5D CB                        	MOV	BL,BYTE [-53+EBP]
   619 0000063C 01 C2                           	ADD	EDX,EAX
   620 0000063E 8B 45 CC                        	MOV	EAX,DWORD [-52+EBP]
   621 00000641 89 55 A4                        	MOV	DWORD [-92+EBP],EDX
   622 00000644 38 1C 02                        	CMP	BYTE [EDX+EAX*1],BL
   623 00000647 74 18                           	JE	L181
   624 00000649                                 L151:
   625 00000649 41                              	INC	ECX
   626 0000064A 83 45 A0 02                     	ADD	DWORD [-96+EBP],2
   627 0000064E 3B 4D E4                        	CMP	ECX,DWORD [-28+EBP]
   628 00000651 7C D7                           	JL	L154
   629 00000653                                 L170:
   630 00000653 46                              	INC	ESI
   631 00000654 03 7D B0                        	ADD	EDI,DWORD [-80+EBP]
   632 00000657 3B 75 E0                        	CMP	ESI,DWORD [-32+EBP]
   633 0000065A 7C B2                           	JL	L155
   634 0000065C E9 FFFFFF01                     	JMP	L97
   635 00000661                                 L181:
   636 00000661 8B 55 A0                        	MOV	EDX,DWORD [-96+EBP]
   637 00000664 8B 5D A4                        	MOV	EBX,DWORD [-92+EBP]
   638 00000667 66 8B 02                        	MOV	AX,WORD [EDX]
   639 0000066A 8B 55 D0                        	MOV	EDX,DWORD [-48+EBP]
   640 0000066D 66 89 04 5A                     	MOV	WORD [EDX+EBX*2],AX
   641 00000671 EB D6                           	JMP	L151
   642 00000673                                 L175:
   643 00000673 89 CE                           	MOV	ESI,ECX
   644 00000675 3B 4D E0                        	CMP	ECX,DWORD [-32+EBP]
   645 00000678 0F 8D FFFFFEE4                  	JGE	L97
   646 0000067E                                 L114:
   647 0000067E 8B 57 10                        	MOV	EDX,DWORD [16+EDI]
   648 00000681 8B 4D E8                        	MOV	ECX,DWORD [-24+EBP]
   649 00000684 01 F2                           	ADD	EDX,ESI
   650 00000686 3B 4D E4                        	CMP	ECX,DWORD [-28+EBP]
   651 00000689 89 55 EC                        	MOV	DWORD [-20+EBP],EDX
   652 0000068C 7D 23                           	JGE	L161
   653 0000068E                                 L113:
   654 0000068E 8B 5D 08                        	MOV	EBX,DWORD [8+EBP]
   655 00000691 8B 45 EC                        	MOV	EAX,DWORD [-20+EBP]
   656 00000694 8B 57 0C                        	MOV	EDX,DWORD [12+EDI]
   657 00000697 0F AF 43 08                     	IMUL	EAX,DWORD [8+EBX]
   658 0000069B 01 CA                           	ADD	EDX,ECX
   659 0000069D 8B 5D CC                        	MOV	EBX,DWORD [-52+EBP]
   660 000006A0 8D 14 02                        	LEA	EDX,DWORD [EDX+EAX*1]
   661 000006A3 8A 45 CB                        	MOV	AL,BYTE [-53+EBP]
   662 000006A6 38 04 1A                        	CMP	BYTE [EDX+EBX*1],AL
   663 000006A9 74 11                           	JE	L182
   664 000006AB                                 L110:
   665 000006AB 41                              	INC	ECX
   666 000006AC 3B 4D E4                        	CMP	ECX,DWORD [-28+EBP]
   667 000006AF 7C DD                           	JL	L113
   668 000006B1                                 L161:
   669 000006B1 46                              	INC	ESI
   670 000006B2 3B 75 E0                        	CMP	ESI,DWORD [-32+EBP]
   671 000006B5 7C C7                           	JL	L114
   672 000006B7 E9 FFFFFEA6                     	JMP	L97
   673 000006BC                                 L182:
   674 000006BC 89 F0                           	MOV	EAX,ESI
   675 000006BE 8B 5D C4                        	MOV	EBX,DWORD [-60+EBP]
   676 000006C1 0F AF 47 04                     	IMUL	EAX,DWORD [4+EDI]
   677 000006C5 01 C8                           	ADD	EAX,ECX
   678 000006C7 8A 04 43                        	MOV	AL,BYTE [EBX+EAX*2]
   679 000006CA 8B 5D D0                        	MOV	EBX,DWORD [-48+EBP]
   680 000006CD 88 04 1A                        	MOV	BYTE [EDX+EBX*1],AL
   681 000006D0 EB D9                           	JMP	L110
   682 000006D2                                 L174:
   683 000006D2 31 C9                           	XOR	ECX,ECX
   684 000006D4 E9 FFFFFCFE                     	JMP	L100
   685 000006D9                                 L173:
   686 000006D9 C7 45 E8 00000000               	MOV	DWORD [-24+EBP],0
   687 000006E0 E9 FFFFFCEA                     	JMP	L99
   688 000006E5                                 L172:
   689 000006E5 C7 45 10 00000000               	MOV	DWORD [16+EBP],0
   690 000006EC E9 FFFFFC5D                     	JMP	L92
   691 000006F1                                 L171:
   692 000006F1 C7 45 0C 00000000               	MOV	DWORD [12+EBP],0
   693 000006F8 E9 FFFFFC47                     	JMP	L91
   694 000006FD                                 	GLOBAL	_sheet_updown
   695 000006FD                                 _sheet_updown:
   696 000006FD 55                              	PUSH	EBP
   697 000006FE 89 E5                           	MOV	EBP,ESP
   698 00000700 57                              	PUSH	EDI
   699 00000701 56                              	PUSH	ESI
   700 00000702 53                              	PUSH	EBX
   701 00000703 51                              	PUSH	ECX
   702 00000704 8B 7D 08                        	MOV	EDI,DWORD [8+EBP]
   703 00000707 8B 5D 0C                        	MOV	EBX,DWORD [12+EBP]
   704 0000070A 8B 77 20                        	MOV	ESI,DWORD [32+EDI]
   705 0000070D 8B 47 18                        	MOV	EAX,DWORD [24+EDI]
   706 00000710 89 45 F0                        	MOV	DWORD [-16+EBP],EAX
   707 00000713 8B 46 10                        	MOV	EAX,DWORD [16+ESI]
   708 00000716 40                              	INC	EAX
   709 00000717 39 C3                           	CMP	EBX,EAX
   710 00000719 7E 02                           	JLE	L184
   711 0000071B 89 C3                           	MOV	EBX,EAX
   712 0000071D                                 L184:
   713 0000071D 83 FB FF                        	CMP	EBX,-1
   714 00000720 7D 03                           	JGE	L185
   715 00000722 83 CB FF                        	OR	EBX,-1
   716 00000725                                 L185:
   717 00000725 89 5F 18                        	MOV	DWORD [24+EDI],EBX
   718 00000728 39 5D F0                        	CMP	DWORD [-16+EBP],EBX
   719 0000072B 0F 8E 000000A8                  	JLE	L186
   720 00000731 85 DB                           	TEST	EBX,EBX
   721 00000733 78 5C                           	JS	L187
   722 00000735 8B 4D F0                        	MOV	ECX,DWORD [-16+EBP]
   723 00000738                                 L192:
   724 00000738 8B 44 8E 10                     	MOV	EAX,DWORD [16+ESI+ECX*4]
   725 0000073C 89 44 8E 14                     	MOV	DWORD [20+ESI+ECX*4],EAX
   726 00000740 89 48 18                        	MOV	DWORD [24+EAX],ECX
   727 00000743 49                              	DEC	ECX
   728 00000744 39 D9                           	CMP	ECX,EBX
   729 00000746 7F F0                           	JG	L192
   730 00000748 89 7C 9E 14                     	MOV	DWORD [20+ESI+EBX*4],EDI
   731 0000074C 43                              	INC	EBX
   732 0000074D 53                              	PUSH	EBX
   733 0000074E 8B 4F 10                        	MOV	ECX,DWORD [16+EDI]
   734 00000751 89 C8                           	MOV	EAX,ECX
   735 00000753 03 47 08                        	ADD	EAX,DWORD [8+EDI]
   736 00000756 50                              	PUSH	EAX
   737 00000757 8B 57 0C                        	MOV	EDX,DWORD [12+EDI]
   738 0000075A 89 D0                           	MOV	EAX,EDX
   739 0000075C 03 47 04                        	ADD	EAX,DWORD [4+EDI]
   740 0000075F 50                              	PUSH	EAX
   741 00000760 51                              	PUSH	ECX
   742 00000761 52                              	PUSH	EDX
   743 00000762 56                              	PUSH	ESI
   744 00000763 E8 FFFFF98D                     	CALL	_sheet_refreshmap
   745 00000768 FF 75 F0                        	PUSH	DWORD [-16+EBP]
   746 0000076B                                 L222:
   747 0000076B 53                              	PUSH	EBX
   748 0000076C                                 L221:
   749 0000076C 8B 4F 10                        	MOV	ECX,DWORD [16+EDI]
   750 0000076F 89 C8                           	MOV	EAX,ECX
   751 00000771 03 47 08                        	ADD	EAX,DWORD [8+EDI]
   752 00000774 50                              	PUSH	EAX
   753 00000775 8B 57 0C                        	MOV	EDX,DWORD [12+EDI]
   754 00000778 89 D0                           	MOV	EAX,EDX
   755 0000077A 03 47 04                        	ADD	EAX,DWORD [4+EDI]
   756 0000077D 50                              	PUSH	EAX
   757 0000077E 51                              	PUSH	ECX
   758 0000077F 52                              	PUSH	EDX
   759 00000780 56                              	PUSH	ESI
   760 00000781 E8 FFFFFB9A                     	CALL	_sheet_refreshsub
   761 00000786 83 C4 34                        	ADD	ESP,52
   762 00000789                                 L183:
   763 00000789 8D 65 F4                        	LEA	ESP,DWORD [-12+EBP]
   764 0000078C 5B                              	POP	EBX
   765 0000078D 5E                              	POP	ESI
   766 0000078E 5F                              	POP	EDI
   767 0000078F 5D                              	POP	EBP
   768 00000790 C3                              	RET
   769 00000791                                 L187:
   770 00000791 8B 46 10                        	MOV	EAX,DWORD [16+ESI]
   771 00000794 3B 45 F0                        	CMP	EAX,DWORD [-16+EBP]
   772 00000797 7E 18                           	JLE	L194
   773 00000799 8B 4D F0                        	MOV	ECX,DWORD [-16+EBP]
   774 0000079C 39 C1                           	CMP	ECX,EAX
   775 0000079E 7D 11                           	JGE	L194
   776 000007A0                                 L199:
   777 000007A0 8B 44 8E 18                     	MOV	EAX,DWORD [24+ESI+ECX*4]
   778 000007A4 89 44 8E 14                     	MOV	DWORD [20+ESI+ECX*4],EAX
   779 000007A8 89 48 18                        	MOV	DWORD [24+EAX],ECX
   780 000007AB 41                              	INC	ECX
   781 000007AC 3B 4E 10                        	CMP	ECX,DWORD [16+ESI]
   782 000007AF 7C EF                           	JL	L199
   783 000007B1                                 L194:
   784 000007B1 FF 4E 10                        	DEC	DWORD [16+ESI]
   785 000007B4 6A 00                           	PUSH	0
   786 000007B6 8B 4F 10                        	MOV	ECX,DWORD [16+EDI]
   787 000007B9 89 C8                           	MOV	EAX,ECX
   788 000007BB 03 47 08                        	ADD	EAX,DWORD [8+EDI]
   789 000007BE 50                              	PUSH	EAX
   790 000007BF 8B 57 0C                        	MOV	EDX,DWORD [12+EDI]
   791 000007C2 89 D0                           	MOV	EAX,EDX
   792 000007C4 03 47 04                        	ADD	EAX,DWORD [4+EDI]
   793 000007C7 50                              	PUSH	EAX
   794 000007C8 51                              	PUSH	ECX
   795 000007C9 52                              	PUSH	EDX
   796 000007CA 56                              	PUSH	ESI
   797 000007CB E8 FFFFF925                     	CALL	_sheet_refreshmap
   798 000007D0 8B 45 F0                        	MOV	EAX,DWORD [-16+EBP]
   799 000007D3 48                              	DEC	EAX
   800 000007D4 50                              	PUSH	EAX
   801 000007D5 6A 00                           	PUSH	0
   802 000007D7 EB 93                           	JMP	L221
   803 000007D9                                 L186:
   804 000007D9 39 5D F0                        	CMP	DWORD [-16+EBP],EBX
   805 000007DC 7D AB                           	JGE	L183
   806 000007DE 83 7D F0 00                     	CMP	DWORD [-16+EBP],0
   807 000007E2 78 3C                           	JS	L202
   808 000007E4 8B 4D F0                        	MOV	ECX,DWORD [-16+EBP]
   809 000007E7 39 D9                           	CMP	ECX,EBX
   810 000007E9 7D 10                           	JGE	L218
   811 000007EB                                 L207:
   812 000007EB 8B 44 8E 18                     	MOV	EAX,DWORD [24+ESI+ECX*4]
   813 000007EF 89 44 8E 14                     	MOV	DWORD [20+ESI+ECX*4],EAX
   814 000007F3 89 48 18                        	MOV	DWORD [24+EAX],ECX
   815 000007F6 41                              	INC	ECX
   816 000007F7 39 D9                           	CMP	ECX,EBX
   817 000007F9 7C F0                           	JL	L207
   818 000007FB                                 L218:
   819 000007FB 89 7C 9E 14                     	MOV	DWORD [20+ESI+EBX*4],EDI
   820 000007FF                                 L208:
   821 000007FF 53                              	PUSH	EBX
   822 00000800 8B 4F 10                        	MOV	ECX,DWORD [16+EDI]
   823 00000803 89 C8                           	MOV	EAX,ECX
   824 00000805 03 47 08                        	ADD	EAX,DWORD [8+EDI]
   825 00000808 50                              	PUSH	EAX
   826 00000809 8B 57 0C                        	MOV	EDX,DWORD [12+EDI]
   827 0000080C 89 D0                           	MOV	EAX,EDX
   828 0000080E 03 47 04                        	ADD	EAX,DWORD [4+EDI]
   829 00000811 50                              	PUSH	EAX
   830 00000812 51                              	PUSH	ECX
   831 00000813 52                              	PUSH	EDX
   832 00000814 56                              	PUSH	ESI
   833 00000815 E8 FFFFF8DB                     	CALL	_sheet_refreshmap
   834 0000081A 53                              	PUSH	EBX
   835 0000081B E9 FFFFFF4B                     	JMP	L222
   836 00000820                                 L202:
   837 00000820 8B 4E 10                        	MOV	ECX,DWORD [16+ESI]
   838 00000823 39 D9                           	CMP	ECX,EBX
   839 00000825 7C 13                           	JL	L220
   840 00000827                                 L213:
   841 00000827 8B 54 8E 14                     	MOV	EDX,DWORD [20+ESI+ECX*4]
   842 0000082B 8D 41 01                        	LEA	EAX,DWORD [1+ECX]
   843 0000082E 89 54 8E 18                     	MOV	DWORD [24+ESI+ECX*4],EDX
   844 00000832 49                              	DEC	ECX
   845 00000833 89 42 18                        	MOV	DWORD [24+EDX],EAX
   846 00000836 39 D9                           	CMP	ECX,EBX
   847 00000838 7D ED                           	JGE	L213
   848 0000083A                                 L220:
   849 0000083A 89 7C 9E 14                     	MOV	DWORD [20+ESI+EBX*4],EDI
   850 0000083E FF 46 10                        	INC	DWORD [16+ESI]
   851 00000841 EB BC                           	JMP	L208
   852 00000843                                 	GLOBAL	_sheet_refresh
   853 00000843                                 _sheet_refresh:
   854 00000843 55                              	PUSH	EBP
   855 00000844 89 E5                           	MOV	EBP,ESP
   856 00000846 53                              	PUSH	EBX
   857 00000847 8B 5D 08                        	MOV	EBX,DWORD [8+EBP]
   858 0000084A 8B 43 18                        	MOV	EAX,DWORD [24+EBX]
   859 0000084D 85 C0                           	TEST	EAX,EAX
   860 0000084F 78 27                           	JS	L223
   861 00000851 50                              	PUSH	EAX
   862 00000852 50                              	PUSH	EAX
   863 00000853 8B 4B 10                        	MOV	ECX,DWORD [16+EBX]
   864 00000856 89 C8                           	MOV	EAX,ECX
   865 00000858 03 4D 10                        	ADD	ECX,DWORD [16+EBP]
   866 0000085B 03 45 18                        	ADD	EAX,DWORD [24+EBP]
   867 0000085E 50                              	PUSH	EAX
   868 0000085F 8B 53 0C                        	MOV	EDX,DWORD [12+EBX]
   869 00000862 89 D0                           	MOV	EAX,EDX
   870 00000864 03 55 0C                        	ADD	EDX,DWORD [12+EBP]
   871 00000867 03 45 14                        	ADD	EAX,DWORD [20+EBP]
   872 0000086A 50                              	PUSH	EAX
   873 0000086B 51                              	PUSH	ECX
   874 0000086C 52                              	PUSH	EDX
   875 0000086D FF 73 20                        	PUSH	DWORD [32+EBX]
   876 00000870 E8 FFFFFAAB                     	CALL	_sheet_refreshsub
   877 00000875 83 C4 1C                        	ADD	ESP,28
   878 00000878                                 L223:
   879 00000878 8B 5D FC                        	MOV	EBX,DWORD [-4+EBP]
   880 0000087B C9                              	LEAVE
   881 0000087C C3                              	RET
   882 0000087D                                 	GLOBAL	_sheet_slide
   883 0000087D                                 _sheet_slide:
   884 0000087D 55                              	PUSH	EBP
   885 0000087E 89 E5                           	MOV	EBP,ESP
   886 00000880 57                              	PUSH	EDI
   887 00000881 56                              	PUSH	ESI
   888 00000882 53                              	PUSH	EBX
   889 00000883 53                              	PUSH	EBX
   890 00000884 8B 5D 08                        	MOV	EBX,DWORD [8+EBP]
   891 00000887 8B 43 20                        	MOV	EAX,DWORD [32+EBX]
   892 0000088A 8B 7B 0C                        	MOV	EDI,DWORD [12+EBX]
   893 0000088D 89 45 F0                        	MOV	DWORD [-16+EBP],EAX
   894 00000890 8B 73 10                        	MOV	ESI,DWORD [16+EBX]
   895 00000893 8B 45 0C                        	MOV	EAX,DWORD [12+EBP]
   896 00000896 89 43 0C                        	MOV	DWORD [12+EBX],EAX
   897 00000899 8B 45 10                        	MOV	EAX,DWORD [16+EBP]
   898 0000089C 89 43 10                        	MOV	DWORD [16+EBX],EAX
   899 0000089F 83 7B 18 00                     	CMP	DWORD [24+EBX],0
   900 000008A3 78 7C                           	JS	L225
   901 000008A5 6A 00                           	PUSH	0
   902 000008A7 89 F0                           	MOV	EAX,ESI
   903 000008A9 03 43 08                        	ADD	EAX,DWORD [8+EBX]
   904 000008AC 50                              	PUSH	EAX
   905 000008AD 89 F8                           	MOV	EAX,EDI
   906 000008AF 03 43 04                        	ADD	EAX,DWORD [4+EBX]
   907 000008B2 50                              	PUSH	EAX
   908 000008B3 56                              	PUSH	ESI
   909 000008B4 57                              	PUSH	EDI
   910 000008B5 FF 75 F0                        	PUSH	DWORD [-16+EBP]
   911 000008B8 E8 FFFFF838                     	CALL	_sheet_refreshmap
   912 000008BD 8B 45 10                        	MOV	EAX,DWORD [16+EBP]
   913 000008C0 FF 73 18                        	PUSH	DWORD [24+EBX]
   914 000008C3 03 43 08                        	ADD	EAX,DWORD [8+EBX]
   915 000008C6 50                              	PUSH	EAX
   916 000008C7 8B 45 0C                        	MOV	EAX,DWORD [12+EBP]
   917 000008CA 03 43 04                        	ADD	EAX,DWORD [4+EBX]
   918 000008CD 50                              	PUSH	EAX
   919 000008CE FF 75 10                        	PUSH	DWORD [16+EBP]
   920 000008D1 FF 75 0C                        	PUSH	DWORD [12+EBP]
   921 000008D4 FF 75 F0                        	PUSH	DWORD [-16+EBP]
   922 000008D7 E8 FFFFF819                     	CALL	_sheet_refreshmap
   923 000008DC 8B 43 18                        	MOV	EAX,DWORD [24+EBX]
   924 000008DF 83 C4 30                        	ADD	ESP,48
   925 000008E2 48                              	DEC	EAX
   926 000008E3 50                              	PUSH	EAX
   927 000008E4 89 F0                           	MOV	EAX,ESI
   928 000008E6 6A 00                           	PUSH	0
   929 000008E8 03 43 08                        	ADD	EAX,DWORD [8+EBX]
   930 000008EB 50                              	PUSH	EAX
   931 000008EC 89 F8                           	MOV	EAX,EDI
   932 000008EE 03 43 04                        	ADD	EAX,DWORD [4+EBX]
   933 000008F1 50                              	PUSH	EAX
   934 000008F2 56                              	PUSH	ESI
   935 000008F3 57                              	PUSH	EDI
   936 000008F4 FF 75 F0                        	PUSH	DWORD [-16+EBP]
   937 000008F7 E8 FFFFFA24                     	CALL	_sheet_refreshsub
   938 000008FC 8B 45 10                        	MOV	EAX,DWORD [16+EBP]
   939 000008FF FF 73 18                        	PUSH	DWORD [24+EBX]
   940 00000902 FF 73 18                        	PUSH	DWORD [24+EBX]
   941 00000905 03 43 08                        	ADD	EAX,DWORD [8+EBX]
   942 00000908 50                              	PUSH	EAX
   943 00000909 8B 45 0C                        	MOV	EAX,DWORD [12+EBP]
   944 0000090C 03 43 04                        	ADD	EAX,DWORD [4+EBX]
   945 0000090F 50                              	PUSH	EAX
   946 00000910 FF 75 10                        	PUSH	DWORD [16+EBP]
   947 00000913 FF 75 0C                        	PUSH	DWORD [12+EBP]
   948 00000916 FF 75 F0                        	PUSH	DWORD [-16+EBP]
   949 00000919 E8 FFFFFA02                     	CALL	_sheet_refreshsub
   950 0000091E 83 C4 38                        	ADD	ESP,56
   951 00000921                                 L225:
   952 00000921 8D 65 F4                        	LEA	ESP,DWORD [-12+EBP]
   953 00000924 5B                              	POP	EBX
   954 00000925 5E                              	POP	ESI
   955 00000926 5F                              	POP	EDI
   956 00000927 5D                              	POP	EBP
   957 00000928 C3                              	RET
   958 00000929                                 	GLOBAL	_sheet_free
   959 00000929                                 _sheet_free:
   960 00000929 55                              	PUSH	EBP
   961 0000092A 89 E5                           	MOV	EBP,ESP
   962 0000092C 53                              	PUSH	EBX
   963 0000092D 8B 5D 08                        	MOV	EBX,DWORD [8+EBP]
   964 00000930 83 7B 18 00                     	CMP	DWORD [24+EBX],0
   965 00000934 78 0A                           	JS	L228
   966 00000936 6A FF                           	PUSH	-1
   967 00000938 53                              	PUSH	EBX
   968 00000939 E8 FFFFFDBF                     	CALL	_sheet_updown
   969 0000093E 58                              	POP	EAX
   970 0000093F 5A                              	POP	EDX
   971 00000940                                 L228:
   972 00000940 C7 43 1C 00000000               	MOV	DWORD [28+EBX],0
   973 00000947 8B 5D FC                        	MOV	EBX,DWORD [-4+EBP]
   974 0000094A C9                              	LEAVE
   975 0000094B C3                              	RET
