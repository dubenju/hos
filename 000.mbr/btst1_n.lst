     1                                  cpu 8086
     2                                  [BITS 16]
     3                                            section .data align=16
     4                                  ;label    :    instruction operands     ; comment
     5 00000000 31C0                                   XOR AX,AX                ; AX: 0000
     6 00000002 8ED0                                   MOV SS,AX                ; SS: 0000
     7 00000004 BC007C                                 MOV SP,0X7C00            ; SP: 7C00
     8 00000007 FB                                     STI                      ; 
     9 00000008 50                                     PUSH AX                  ;
    10 00000009 07                                     POP ES                   ; ES: 0000
    11 0000000A 50                                     PUSH AX                  ;
    12 0000000B 1F                                     POP DS                   ; DS: 0000
    13 0000000C FC                                     CLD                      ;
    14 0000000D BE1B7C                                 MOV SI,0X7C1B            ; SI: 7C1B
    15 00000010 BF1B06                                 MOV DI,0X061B            ; DI: 061B
    16 00000013 50                                     PUSH AX                  ;
    17 00000014 57                                     PUSH DI                  ;
    18 00000015 B9E501                                 MOV CX,0X01E5            ; CX: 01E5
    19 00000018 F3A4                                   REP MOVSB                ; CX: 0000
    20 0000001A CB                                     RETF                     ; IP: 061B CS:0000
    21 0000001B BEBE07                                 MOV SI,0X07BE
    22 0000001E B104                                   MOV CL,0X04
    23                                  CHK_PTE   :
    24 00000020 382C                                   CMP [SI],CH
    25 00000022 7C09                                   JL SCH_PTE   
    26 00000024 7515                                   JNZ _DSP_ERROR_MSG
    27 00000026 83C610                                 ADD SI,BYTE +0X10
    28 00000029 E2F5                                   LOOP CHK_PTE
    29 0000002B CD18                                   INT 0X18
    30                                  SCH_PTE   :
    31 0000002D 8B14                                   MOV DX,[SI]
    32 0000002F 89F5                                   MOV BP,SI
    33                                  _MOVE_TO_NEXT_ENTRY:
    34 00000031 83C610                                 ADD SI,BYTE +0X10
    35 00000034 49                                     DEC CX
    36 00000035 7416                                   JZ _CHK_SYSTEM_ID_FOR_FAT
    37 00000037 382C                                   CMP [SI],CH
    38 00000039 74F6                                   JZ _MOVE_TO_NEXT_ENTRY
    39                                  _DSP_ERROR_MSG:
    40 0000003B BE1007                                 MOV SI,0X710
    41                                  _DSP_NEXT_CHAR:
    42 0000003E 4E                                     DEC SI
    43                                  _LBL_0000003F:
    44 0000003F AC                                     LODSB
    45 00000040 3C00                                   CMP AL,0X0
    46 00000042 74FA                                   JZ _DSP_NEXT_CHAR
    47 00000044 BB0700                                 MOV BX,0X7
    48 00000047 B40E                                   MOV AH,0XE
    49 00000049 CD10                                   INT 0X10
    50                                  _LBL_0000004B:
    51 0000004B EBF2                                   JMP SHORT _LBL_0000003F
    52                                  _CHK_SYSTEM_ID_FOR_FAT:
    53 0000004D 894625                                 MOV [BP+0X25],AX
    54 00000050 96                                     XCHG AX,SI
    55 00000051 8A4604                                 MOV AL,[BP+0X4]
    56 00000054 B406                                   MOV AH,0X6
    57 00000056 3C0E                                   CMP AL,0XE
    58 00000058 7411                                   JZ _LBL_0000006B
    59 0000005A B40B                                   MOV AH,0XB
    60 0000005C 3C0C                                   CMP AL,0XC
    61 0000005E 7405                                   JZ _LBL_00000065
    62 00000060 38E0                                   CMP AL,AH
    63 00000062 752B                                   JNZ _LBL_0000008F
    64 00000064 40                                     INC AX
    65                                  _LBL_00000065:
    66 00000065 C6462506                               MOV BYTE [BP+0X25],0X6
    67 00000069 7524                                   JNZ _LBL_0000008F
    68                                  _LBL_0000006B:
    69 0000006B BBAA55                                 MOV BX,0X55AA
    70 0000006E 50                                     PUSH AX
    71 0000006F B441                                   MOV AH,0X41
    72 00000071 CD13                                   INT 0X13
    73 00000073 58                                     POP AX
    74 00000074 7216                                   JC LBL_0000008C
    75 00000076 81FB55AA                               CMP BX,0XAA55
    76 0000007A 7510                                   JNZ LBL_0000008C
    77 0000007C F6C101                                 TEST CL,0X1
    78 0000007F 740B                                   JZ LBL_0000008C
    79 00000081 88C4                                   MOV AH,AL
    80 00000083 885624                                 MOV [BP+0X24],DL
    81 00000086 C706A106EB1E                           MOV WORD [0X6A1],0X1EEB
    82                                  LBL_0000008C:
    83 0000008C 886604                                 MOV [BP+0X4],AH
    84                                  _LBL_0000008F:
    85 0000008F BF0A00                                 MOV DI,0XA
    86                                  _LBL_00000092:
    87 00000092 B80102                                 MOV AX,0X201
    88 00000095 89E3                                   MOV BX,SP
    89 00000097 31C9                                   XOR CX,CX
    90 00000099 83FF05                                 CMP DI,BYTE +0X5
    91 0000009C 7F03                                   JG LBL_000000A1
    92 0000009E 8B4E25                                 MOV CX,[BP+0X25]
    93                                  LBL_000000A1:
    94 000000A1 034E02                                 ADD CX,[BP+0X2]
    95 000000A4 CD13                                   INT 0X13
    96                                  _LBL000000A6:
    97 000000A6 722C                                   JC LBL_000000D1
    98 000000A8 BE4607                                 MOV SI,0X746
    99 000000AB 813EFE7D55AA                           CMP WORD [0X7DFE],0XAA55
   100 000000B1 7503E9(0D01)                                          JZ 0X10D
   101 000000B6 83EF05                                 SUB DI,BYTE +0X5
   102 000000B9 7FD7                                   JG _LBL_00000092
   103                                  _LBL_000000B8:
   104 000000BB 85F6                                   TEST SI,SI
   105 000000BD 7580                                   JNZ _LBL_0000003F
   106 000000BF BE2707                                 MOV SI,0X727
   107 000000C2 EB87                                   JMP SHORT _LBL_0000004B
   108 000000C4 98                                     CBW
   109 000000C5 91                                     XCHG AX,CX
   110 000000C6 52                                     PUSH DX
   111 000000C7 99                                     CWD
   112 000000C8 034608                                 ADD AX,[BP+0X8]
   113 000000CB 13560A                                 ADC DX,[BP+0XA]
   114 000000CE E81200                                 CALL WORD _LBL_0XE0
   115 000000D1 5A                                     POP DX
   116 000000D2 EBD2                                   JMP SHORT _LBL000000A6
   117                                  LBL_000000D1:
   118 000000D4 4F                                     DEC DI
   119 000000D5 74E4                                   JZ _LBL_000000B8
   120 000000D7 31C0                                   XOR AX,AX
   121 000000D9 CD13                                   INT 0X13
   122 000000DB EBB5                                   JMP SHORT _LBL_00000092
   123                                  
   124                                  ;DB 0, 0, 0, 0, 0, 0
   125 000000DD 00<rept>                TIMES 6 DB 0
   126                                  
   127                                  _LBL_0XE0:
   128 000000E3 56                                     PUSH SI
   129 000000E4 31F6                                   XOR SI,SI
   130 000000E6 56                                     PUSH SI
   131 000000E7 56                                     PUSH SI
   132 000000E8 52                                     PUSH DX
   133 000000E9 50                                     PUSH AX
   134 000000EA 06                                     PUSH ES
   135 000000EB 53                                     PUSH BX
   136 000000EC 51                                     PUSH CX
   137 000000ED BE1000                                 MOV SI,0X10
   138 000000F0 56                                     PUSH SI
   139 000000F1 89E6                                   MOV SI,SP
   140 000000F3 50                                     PUSH AX
   141 000000F4 52                                     PUSH DX
   142 000000F5 B80042                                 MOV AX,0X4200
   143 000000F8 8A5624                                 MOV DL,[BP+0X24]
   144 000000FB CD13                                   INT 0X13
   145 000000FD 5A                                     POP DX
   146 000000FE 58                                     POP AX
   147 000000FF 8D6410                                 LEA SP,[SI+0X10]
   148 00000102 720A                                   JC _LBL_00000105
   149                                  _LBL_0XFB:
   150 00000104 40                                     INC AX
   151 00000105 7501                                   JNZ _LBL_000000FF
   152 00000107 42                                     INC DX
   153                                  _LBL_000000FF:
   154 00000108 80C702                                 ADD BH,0X2
   155 0000010B E2F7                                   LOOP _LBL_0XFB
   156 0000010D F8                                     CLC
   157                                  _LBL_00000105:
   158 0000010E 5E                                     POP SI
   159 0000010F C3                                     RET
   160 00000110 EB(7D)                                                JMP SHORT 0X17D
   161                                  
   162 00000112 496E76616C69642070-     MSG1 DB 'Invalid partition table', 0
   163 0000011B 6172746974696F6E20-
   164 00000124 7461626C6500       
   165 0000012A 4572726F72206C6F61-     MSG2 DB 'Error loading operating system', 0
   166 00000133 64696E67206F706572-
   167 0000013C 6174696E6720737973-
   168 00000145 74656D00           
   169 00000149 4D697373696E67206F-     MSG3 DB 'Missing operating system', 0
   170 00000152 7065726174696E6720-
   171 0000015B 73797374656D00     
